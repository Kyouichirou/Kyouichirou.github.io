<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Lian个人博客-数据与思考">
<meta name="description" content="Make Thing Better and Simpler">
<meta name="theme-color" content="#000">
<title>线性回归 - 异常 | Lian</title>
<link rel="shortcut icon" href="/favicon.ico?v=1758516680740">
<link rel="stylesheet" href="/media/css/mist.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/tomorrow-night.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbnet.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbscript-html.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbscript.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/sql.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/velocity/1.5.1/velocity.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/velocity/1.5.1/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.11.1/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ["\\(", "\\)"]],
      displayMath: [['$$', '$$'], ["\\[", "\\]"]]
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'a', 'annotation', 'annotation-xml'],
      ignoreHtmlClass: 'tex2jax_ignore|crayon-.*', // 'crayon-' 开头的类，属于Wordpress代码高亮库，这部分不需要处理，否则会导致显示不正确,这部分是正则式，多条之间用'|'分割
      processHtmlClass: 'tex2jax_process'
    },
    //禁用右键菜单	
    renderActions: {
      addMenu: [0, '', '']
    }
  };
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




<script>
  var _hmt = _hmt || [];
  (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?19bd452dc174a21cc99fb66ddfcef0cc";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>



  <meta name="description" content="线性回归 - 异常" />
  <meta name="keywords" content="spss,math" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">Lian</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-globe"></i> Home
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives" target="_self">
                  <i class="fa fa-globe"></i> Archives
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags" target="_self">
                  <i class="fa fa-globe"></i> Tags
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://Kyouichirou.github.io/post/about-me" target="_self">
                  <i class="fa fa-globe"></i> About
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </li>
            
          
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout mist bg-color">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper  right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">文章目录</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">站点概览</span>
          </div>
        </div>
      
      <div class="sidebar-body mist" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">Lian</p>
    
    <div class="site-description right-motion">
      
      
      
        <p>make thing better and simpler.</p>
      
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">103</span>
        <span class="site-item-stat-name language" data-lan="article">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">64</span>
        <span class="site-item-stat-name language" data-lan="tag">标签</span>
      </a>
    </div>
  </div>
  
  



</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper  auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%B8%80-%E5%89%8D%E8%A8%80">一. 前言</a></li>
<li><a href="#%E4%BA%8C-%E5%BC%82%E5%B8%B8">二. 异常</a>
<ul>
<li><a href="#21-%E5%BC%82%E5%B8%B8%E7%82%B9">2.1 异常点</a></li>
<li><a href="#22-%E9%AB%98%E6%9D%A0%E6%9D%86%E7%82%B9">2.2 高杠杆点</a>
<ul>
<li><a href="#221-spss%E6%9D%A0%E6%9D%86%E7%8E%87%E8%AE%A1%E7%AE%97">2.2.1 SPSS杠杆率计算</a></li>
<li><a href="#222-%E5%B8%BD%E5%AD%90%E7%9F%A9%E9%98%B5">2.2.2 帽子矩阵</a></li>
</ul>
</li>
<li><a href="#23-%E5%BC%BA%E5%BD%B1%E5%93%8D%E7%82%B9">2.3 强影响点</a>
<ul>
<li><a href="#231-cook%E8%B7%9D%E7%A6%BB%E8%AE%A1%E7%AE%97">2.3.1 cook距离计算</a></li>
</ul>
</li>
<li><a href="#24-%E5%B0%8F%E7%BB%93">2.4 小结</a></li>
<li><a href="#25-%E5%BC%82%E5%B8%B8%E7%9A%84%E5%A4%84%E7%90%86">2.5 异常的处理</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89-%E5%8F%82%E8%80%83">三. 参考</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // 保存li元素
      if (elem.children[0] && elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // 处理不是从#一级标题开始目录
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    jQuery.Velocity(hideElement, 'stop');
    jQuery.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        jQuery.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://Kyouichirou.github.io/post/xian-xing-hui-gui-yi-chang/"> 线性回归 - 异常 </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">发布于</span>
      <span class="publish-time" data-t="2023-05-23 15:44:05">2023-05-23</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">标签:</span>
       
      <a href="https://Kyouichirou.github.io/tag/Q2P6FXAzPd/"> <span>spss</span> </a>、   
      <a href="https://Kyouichirou.github.io/tag/bxmmKSW1O/">
        <span>math</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >21<span class="language" data-lan="minute"
          >分钟</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >4295<span class="pc-show language" data-lan="words"
          >字数</span
        ></span
      >
    </span>
    
  </div>
</section>

            <div class="post-body next-md-body" id="post_body">
              <h2 id="一-前言">一. 前言</h2>
<p>在<a href="https://kyouichirou.github.io/post/yi-yuan-xian-xing-hui-gui-xiang-jie/">一元线性回归详解 | Lian (kyouichirou.github.io)</a>, 在学生化残差章节中, 部分提及了关于帽子矩阵的内容, 这里对该部分的内容进行扩充.</p>
<!--more-->
<p>该部分内容可认为是作为残差的辅助判断, 或者补充.</p>
<p><strong>SPSS中关于回归-异常的计算</strong>:</p>
<p>相关的计算被放置在<code>保存</code>这个选项下(为什么会/要放在这个选项之下呢?)</p>
<figure data-type="image" tabindex="1"><a href="https://imgse.com/i/p9Tnj6H"><img src="https://s1.ax1x.com/2023/05/23/p9Tnj6H.png" alt="p9Tnj6H.png" loading="lazy"></a></figure>
<blockquote>
<p>距离, 标识以下个案的测量: 自变量的值具有异常组合的个案 以及可能对回归模型产生很大影响的个案.</p>
<ul>
<li>Mahalanobis. 自变量上个案的值与所有个案的平均值相异程度的测量. 大的马氏距离表示个案在一个或多个自变量上具有极值.</li>
<li>Cook. 在特定个案从回归系数的计算中排除的情况下 所有个案的残差变化幅度的测量. 较大的 Cook 距离表明从回归统计的计算中排除个案之后 系数会发生根本变化.</li>
<li>杠杆值. 度量某个点对回归拟合的影响. 集中的杠杆值范围为从 0( 对拟合无影响) 到 (N-1)/N.</li>
</ul>
<p><a href="https://www.ibm.com/docs/en/spss-statistics/26.0.0?topic=regression-linear-saving-new-variables">Linear Regression: Saving New Variables - IBM Documentation</a></p>
</blockquote>
<p><em>注意spss其中的部分计算结果和相关公式/python的计算有一定出入.</em></p>
<h2 id="二-异常">二. 异常</h2>
<pre><code class="language-bash">Row	x	    y
1	0.1	   -0.0716
2	0.45401	4.1673
3	1.09765	6.5703
4	1.27936	13.815
5	2.20611	11.4501
6	2.50064	12.9554
7	3.0403	20.1575
8	3.23583	17.5633
9	4.45308	26.0317
10	4.1699	22.7573
11	5.28474	26.303
12	5.59238	30.6885
13	5.92091	33.9402
14	6.66066	30.9228
15	6.79953	34.11
16	7.97943	44.4536
17	8.41536	46.5022
18	8.71607	50.0568
19	8.70156	46.5475
20	9.16463	45.7762
</code></pre>
<p>通过修改上述数据的某个值, 来演示以下的异常点对于模型的影响.</p>
<h3 id="21-异常点">2.1 异常点</h3>
<p><code>Outlier</code>, 即观测值\hat{y}和因变量y之间残差很大的点, 即y的异常值.</p>
<pre><code class="language-bash">Row	x	    y
1	0.1	    -0.0716
2	0.45401	4.1673
3	1.09765	6.5703
4	1.27936	13.815
5	2.20611	11.4501
6	2.50064	12.9554
7	3.0403	20.1575
8	3.23583	17.5633
9	4.45308	26.0317
10	4.1699	22.7573
11	5.28474	26.303
12	5.59238	30.6885
13	5.92091	33.9402
14	6.66066	30.9228
15	6.79953	34.11
16	7.97943	44.4536
17	8.41536	46.5022
18	8.71607	50.0568
19	8.70156	46.5475
20	9.16463	45.7762
21	4	    40
</code></pre>
<figure data-type="image" tabindex="2"><a href="https://imgse.com/i/p9TSt0J"><img src="https://s1.ax1x.com/2023/05/23/p9TSt0J.png" alt="p9TSt0J.png" loading="lazy"></a></figure>
<p>存在异常点和剔除掉之后的拟合方程的变化.</p>
<p><strong>存在异常点:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.953966</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.910051</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.905317</td>
</tr>
<tr>
<td>标准误差</td>
<td>4.71075</td>
</tr>
<tr>
<td>观测值</td>
<td>21</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>4265.823</td>
<td>4265.823</td>
<td>192.2307</td>
<td>2.18E-11</td>
</tr>
<tr>
<td>残差</td>
<td>19</td>
<td>421.6322</td>
<td>22.19117</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>20</td>
<td>4687.456</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>2.957638</td>
<td>2.009065</td>
<td>1.472147</td>
<td>0.157353</td>
<td>-1.24738</td>
<td>7.162659</td>
<td>-1.24738</td>
<td>7.162659</td>
</tr>
<tr>
<td>X Variable 1</td>
<td>5.037345</td>
<td>0.363321</td>
<td>13.86473</td>
<td>2.18E-11</td>
<td>4.276905</td>
<td>5.797784</td>
<td>4.276905</td>
<td>5.797784</td>
</tr>
</tbody>
</table>
<p><strong>剔除掉异常点:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.986493</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.973168</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.971677</td>
</tr>
<tr>
<td>标准误差</td>
<td>2.591988</td>
</tr>
<tr>
<td>观测值</td>
<td>20</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>4386.068</td>
<td>4386.068</td>
<td>652.8441</td>
<td>1.35E-15</td>
</tr>
<tr>
<td>残差</td>
<td>18</td>
<td>120.9312</td>
<td>6.7184</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>19</td>
<td>4506.999</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>1.732178</td>
<td>1.120518</td>
<td>1.545873</td>
<td>0.139536</td>
<td>-0.62194</td>
<td>4.086298</td>
<td>-0.62194</td>
<td>4.086298</td>
</tr>
<tr>
<td>X Variable 1</td>
<td>5.116869</td>
<td>0.200262</td>
<td>25.55081</td>
<td>1.35E-15</td>
<td>4.696133</td>
<td>5.537605</td>
<td>4.696133</td>
<td>5.537605</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>COO_1</th>
<th>LEV_1</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.07308</td>
<td>0.12868</td>
</tr>
<tr>
<td>0.0058</td>
<td>0.10983</td>
</tr>
<tr>
<td>0.01379</td>
<td>0.0794</td>
</tr>
<tr>
<td>0.06749</td>
<td>0.07169</td>
</tr>
<tr>
<td>0.01596</td>
<td>0.03853</td>
</tr>
<tr>
<td>0.01391</td>
<td>0.03012</td>
</tr>
<tr>
<td>0.00595</td>
<td>0.01741</td>
</tr>
<tr>
<td>0.0045</td>
<td>0.01366</td>
</tr>
<tr>
<td>0.00049</td>
<td>0.00053</td>
</tr>
<tr>
<td>0.0018</td>
<td>0.00201</td>
</tr>
<tr>
<td>0.01319</td>
<td>0.00169</td>
</tr>
<tr>
<td>0.00025</td>
<td>0.00421</td>
</tr>
<tr>
<td>0.00189</td>
<td>0.00814</td>
</tr>
<tr>
<td>0.05628</td>
<td>0.02169</td>
</tr>
<tr>
<td>0.01826</td>
<td>0.02496</td>
</tr>
<tr>
<td>0.00527</td>
<td>0.062</td>
</tr>
<tr>
<td>0.00502</td>
<td>0.07987</td>
</tr>
<tr>
<td>0.04396</td>
<td>0.09352</td>
</tr>
<tr>
<td>0.00025</td>
<td>0.09283</td>
</tr>
<tr>
<td>0.05897</td>
<td>0.11587</td>
</tr>
<tr>
<td>0.36391</td>
<td>0.00336</td>
</tr>
</tbody>
</table>
<p>二者的表现特征:</p>
<ul>
<li>异常点, 在图像上表现游离于拟合直线之外明显.</li>
<li>剔除该点前后的标准误差变化较大, 提出后标准误差缩小, R值改善.</li>
</ul>
<h3 id="22-高杠杆点">2.2 高杠杆点</h3>
<p><code>High Leverage Point</code>, 远离样本空间中心的点, 即自变量x的异常观测值.</p>
<blockquote>
<p>高杠杆值的观测点可通过帽子统计量( hat statistic) 判断. 对于一个给定的数据集 帽子均值为 <code>p / n</code> 其中p是模型估计的参数数目( 包含截距项)  n 是样本量. 一般来说 若观测点的帽子值大于帽子均值的2或3倍 就可以认定为高杠杆值点.</p>
<p>p: 即为自变量 + 1</p>
<p>&lt; R语言实战 &gt;, 第二版</p>
</blockquote>
<pre><code class="language-bash">Row	x	   y
1	0.1	   -0.0716
2	0.45401	4.1673
3	1.09765	6.5703
4	1.27936	13.815
5	2.20611	11.4501
6	2.50064	12.9554
7	3.0403	20.1575
8	3.23583	17.5633
9	4.45308	26.0317
10	4.1699	22.7573
11	5.28474	26.303
12	5.59238	30.6885
13	5.92091	33.9402
14	6.66066	30.9228
15	6.79953	34.11
16	7.97943	44.4536
17	8.41536	46.5022
18	8.71607	50.0568
19	8.70156	46.5475
20	9.16463	45.7762
21	14	    68
</code></pre>
<figure data-type="image" tabindex="3"><a href="https://imgse.com/i/p9TpA41"><img src="https://s1.ax1x.com/2023/05/23/p9TpA41.png" alt="p9TpA41.png" loading="lazy"></a></figure>
<p><strong>高杠杆点:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.988632</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.977393</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.976203</td>
</tr>
<tr>
<td>标准误差</td>
<td>2.709112</td>
</tr>
<tr>
<td>观测值</td>
<td>21</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>6028.817</td>
<td>6028.817</td>
<td>821.4443</td>
<td>4.23E-17</td>
</tr>
<tr>
<td>残差</td>
<td>19</td>
<td>139.4465</td>
<td>7.339288</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>20</td>
<td>6168.263</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>2.467879</td>
<td>1.07566</td>
<td>2.294293</td>
<td>0.03334</td>
<td>0.216497</td>
<td>4.719261</td>
<td>0.216497</td>
<td>4.719261</td>
</tr>
<tr>
<td>X Variable 1</td>
<td>4.927221</td>
<td>0.171915</td>
<td>28.66085</td>
<td>4.23E-17</td>
<td>4.567399</td>
<td>5.287043</td>
<td>4.567399</td>
<td>5.287043</td>
</tr>
</tbody>
</table>
<p><strong>剔除后:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.986493</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.973168</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.971677</td>
</tr>
<tr>
<td>标准误差</td>
<td>2.591988</td>
</tr>
<tr>
<td>观测值</td>
<td>20</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>4386.068</td>
<td>4386.068</td>
<td>652.8441</td>
<td>1.35E-15</td>
</tr>
<tr>
<td>残差</td>
<td>18</td>
<td>120.9312</td>
<td>6.7184</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>19</td>
<td>4506.999</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>1.732178</td>
<td>1.120518</td>
<td>1.545873</td>
<td>0.139536</td>
<td>-0.62194</td>
<td>4.086298</td>
<td>-0.62194</td>
<td>4.086298</td>
</tr>
<tr>
<td>X Variable 1</td>
<td>5.116869</td>
<td>0.200262</td>
<td>25.55081</td>
<td>1.35E-15</td>
<td>4.696133</td>
<td>5.537605</td>
<td>4.696133</td>
<td>5.537605</td>
</tr>
</tbody>
</table>
<p><strong>杠杆值和cook距离</strong></p>
<table>
<thead>
<tr>
<th>COO_1</th>
<th>LEV_1</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.13416</td>
<td>0.10586</td>
</tr>
<tr>
<td>0.0037</td>
<td>0.09175</td>
</tr>
<tr>
<td>0.0173</td>
<td>0.06867</td>
</tr>
<tr>
<td>0.24169</td>
<td>0.06276</td>
</tr>
<tr>
<td>0.02443</td>
<td>0.03675</td>
</tr>
<tr>
<td>0.02088</td>
<td>0.02994</td>
</tr>
<tr>
<td>0.03841</td>
<td>0.01926</td>
</tr>
<tr>
<td>0.00355</td>
<td>0.01597</td>
</tr>
<tr>
<td>0.00994</td>
<td>0.00241</td>
</tr>
<tr>
<td>0.00026</td>
<td>0.0045</td>
</tr>
<tr>
<td>0.01738</td>
<td>0.00001</td>
</tr>
<tr>
<td>0.0016</td>
<td>0.00054</td>
</tr>
<tr>
<td>0.01975</td>
<td>0.00194</td>
</tr>
<tr>
<td>0.08134</td>
<td>0.00827</td>
</tr>
<tr>
<td>0.01529</td>
<td>0.00995</td>
</tr>
<tr>
<td>0.04462</td>
<td>0.0305</td>
</tr>
<tr>
<td>0.04796</td>
<td>0.04093</td>
</tr>
<tr>
<td>0.1739</td>
<td>0.04902</td>
</tr>
<tr>
<td>0.01166</td>
<td>0.04861</td>
</tr>
<tr>
<td>0.03232</td>
<td>0.06243</td>
</tr>
<tr>
<td>0.70196</td>
<td>0.30992</td>
</tr>
</tbody>
</table>
<p>从上述的内容来看, 剔除前后的数据, 整体的变化不大, 几个关键指标, R方, 标准误差, F值, P值等均未发生大的变化.</p>
<h4 id="221-spss杠杆率计算">2.2.1 SPSS杠杆率计算</h4>
<p><code>spss</code>这里挖了个<strong>坑</strong>, 其官方文档中也没有提及为什么进行这个操作.</p>
<p><em>spss的文档不给出相关内容的计算公式, 这一点相当恶心.</em></p>
<p>使用之前文章<a href="https://kyouichirou.github.io/post/yi-yuan-xian-xing-hui-gui-xiang-jie/">一元线性回归详解 | Lian (kyouichirou.github.io)</a>的数据集.</p>
<pre><code class="language-python">import numpy as np

# 使用之前的例子

y =np.array([
    3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    11, 13, 13, 16, 17, 18, 17, 19, 21
])

y = y[:, np.newaxis]

x = np.array([[e, 1] for e in range(1, 21)])

xm = np.mat(x)

# 将对角线元素取出, 即为观测值的帽子量, 即杠杆率
np.diagonal((xm * (xm.T* xm).I * xm.T))

array([0.18571429, 0.15864662, 0.13458647, 0.11353383, 0.09548872,
       0.08045113, 0.06842105, 0.0593985 , 0.05338346, 0.05037594,
       0.05037594, 0.05338346, 0.0593985 , 0.06842105, 0.08045113,
       0.09548872, 0.11353383, 0.13458647, 0.15864662, 0.18571429])
</code></pre>
<table>
<thead>
<tr>
<th>COO_1</th>
<th>LEV_1</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.14238</td>
<td>0.13571</td>
</tr>
<tr>
<td>0.1185</td>
<td>0.10865</td>
</tr>
<tr>
<td>0.09875</td>
<td>0.08459</td>
</tr>
<tr>
<td>0.0117</td>
<td>0.06353</td>
</tr>
<tr>
<td>0.29304</td>
<td>0.04549</td>
</tr>
<tr>
<td>0.11503</td>
<td>0.03045</td>
</tr>
<tr>
<td>0.00163</td>
<td>0.01842</td>
</tr>
<tr>
<td>0.00113</td>
<td>0.0094</td>
</tr>
<tr>
<td>0.04067</td>
<td>0.00338</td>
</tr>
<tr>
<td>0.06076</td>
<td>0.00038</td>
</tr>
<tr>
<td>0.00823</td>
<td>0.00038</td>
</tr>
<tr>
<td>0.01761</td>
<td>0.00338</td>
</tr>
<tr>
<td>0.00023</td>
<td>0.0094</td>
</tr>
<tr>
<td>0.02095</td>
<td>0.01842</td>
</tr>
<tr>
<td>0.01845</td>
<td>0.03045</td>
</tr>
<tr>
<td>0.02411</td>
<td>0.04549</td>
</tr>
<tr>
<td>0.03174</td>
<td>0.06353</td>
</tr>
<tr>
<td>0.03783</td>
<td>0.08459</td>
</tr>
<tr>
<td>0.00015</td>
<td>0.10865</td>
</tr>
<tr>
<td>0.07319</td>
<td>0.13571</td>
</tr>
</tbody>
</table>
<p>可以很明显的看出, <code>spss</code>计算的杠杆率的数值比帽子矩阵对角线元素略小, 假如拖拽相减, 会发现这个差值大概为<code>0.05</code>.</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">杠</mi><mi mathvariant="normal">杆</mi><mi mathvariant="normal">率</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">计</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">公</mi><mi mathvariant="normal">式</mi><mo>:</mo><mspace linebreak="newline"></mspace><msub><mi>h</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><mo>+</mo><mfrac><mrow><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><mi>x</mi><mo>ˉ</mo></mover><msup><mo>)</mo><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mi>n</mi><mo separator="true">,</mo><mi mathvariant="normal">为</mi><mi mathvariant="normal">样</mi><mi mathvariant="normal">本</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">量</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">假</mi><mi mathvariant="normal">如</mi><mi>n</mi><mi mathvariant="normal">趋</mi><mi mathvariant="normal">向</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">无</mi><mi mathvariant="normal">穷</mi><mi mathvariant="normal">大</mi><mo separator="true">,</mo><mi mathvariant="normal">那</mi><mi mathvariant="normal">么</mi><mi mathvariant="normal">任</mi><mi mathvariant="normal">意</mi><mi mathvariant="normal">的</mi><msub><mi>h</mi><mi>i</mi></msub><mo>≈</mo><mn>0</mn><mspace linebreak="newline"></mspace><mi mathvariant="normal">注</mi><mo>:</mo><mi mathvariant="normal">由</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">计</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">中</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">大</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">浮</mi><mi mathvariant="normal">点</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">差</mi><mi mathvariant="normal">和</mi><mi mathvariant="normal">省</mi><mi mathvariant="normal">略</mi><mo separator="true">,</mo><mi mathvariant="normal">计</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">结</mi><mi mathvariant="normal">果</mi><mi mathvariant="normal">和</mi><mi mathvariant="normal">帽</mi><mi mathvariant="normal">子</mi><mi mathvariant="normal">矩</mi><mi mathvariant="normal">阵</mi><mi mathvariant="normal">计</mi><mi mathvariant="normal">算</mi><mi mathvariant="normal">有</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">定</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">差</mi><mi mathvariant="normal">异</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">杠杆率的计算公式:\\
h_i = \frac{1}{n} + \frac{(x_i - \bar{x}) ^ 2}{\sum_{i=1}^n (x_i - \bar{x}) ^ 2}\\
n, 为样本数量\\
假如n趋向于无穷大, 那么任意的h_i \approx 0\\
注: 由于计算中的大量浮点数的偏差和省略, 计算的结果和帽子矩阵计算有一定的差异.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord cjk_fallback">杠</span><span class="mord cjk_fallback">杆</span><span class="mord cjk_fallback">率</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">公</span><span class="mord cjk_fallback">式</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.00744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.32144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">n</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.48511em;vertical-align:-0.994002em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.305708em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">ˉ</span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.56778em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">x</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.22222em;">ˉ</span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994002em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">样</span><span class="mord cjk_fallback">本</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">量</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">假</span><span class="mord cjk_fallback">如</span><span class="mord mathdefault">n</span><span class="mord cjk_fallback">趋</span><span class="mord cjk_fallback">向</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">无</span><span class="mord cjk_fallback">穷</span><span class="mord cjk_fallback">大</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">那</span><span class="mord cjk_fallback">么</span><span class="mord cjk_fallback">任</span><span class="mord cjk_fallback">意</span><span class="mord cjk_fallback">的</span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">0</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord cjk_fallback">注</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.3em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">浮</span><span class="mord cjk_fallback">点</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">差</span><span class="mord cjk_fallback">和</span><span class="mord cjk_fallback">省</span><span class="mord cjk_fallback">略</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">结</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">和</span><span class="mord cjk_fallback">帽</span><span class="mord cjk_fallback">子</span><span class="mord cjk_fallback">矩</span><span class="mord cjk_fallback">阵</span><span class="mord cjk_fallback">计</span><span class="mord cjk_fallback">算</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">差</span><span class="mord cjk_fallback">异</span><span class="mord">.</span></span></span></span></span></p>
<p>从上面的公式可以很快猜出该差值<code>0.05</code>, 就是<code>1/n</code>, 这个部分被<code>spss</code>省略.</p>
<h4 id="222-帽子矩阵">2.2.2 帽子矩阵</h4>
<p><code>hat matrix</code>, 帽子矩阵</p>
<p><code>hat statistic</code>, 帽子统计量</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>Y</mi><mo>^</mo></mover><mo>=</mo><msub><mi>h</mi><mrow><mi>i</mi><mn>1</mn></mrow></msub><msub><mi>Y</mi><mn>1</mn></msub><mo>+</mo><msub><mi>h</mi><mrow><mi>i</mi><mn>2</mn></mrow></msub><msub><mi>Y</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>+</mo><msub><mi>h</mi><mrow><mi>i</mi><mi>n</mi></mrow></msub><msub><mi>Y</mi><mi>n</mi></msub><mo>=</mo><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>h</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><msub><mi>Y</mi><mi>j</mi></msub><mspace linebreak="newline"></mspace><mspace linebreak="newline"></mspace><mover accent="true"><mi>y</mi><mo>^</mo></mover><mo>=</mo><mi>X</mi><mi>b</mi><mo>=</mo><mi>X</mi><mo>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>y</mi><mo>=</mo><mi>H</mi><mi>y</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">即</mi><mo separator="true">,</mo><mi>H</mi><mo>=</mo><mi>X</mi><mo>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup></mrow><annotation encoding="application/x-tex">\hat{Y} = h_{i1}Y_1 + h_{i2}Y_2 + ... + h_{in}Y_n = \sum_{j=1}^n h_{ij}Y_j\\
\\
\hat{y} = Xb
= X(X^TX)^{-1}X^Ty = Hy\\
即, H = X(X^TX)^{-1}X^T
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9467699999999999em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0651740000000007em;vertical-align:-1.4137769999999998em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000007em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4137769999999998em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.22222em;">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.22222em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.19444em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">即</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span></span></span></span></p>
<pre><code class="language-python">import numpy as np
from statsmodels.tools.tools import add_constant

a = np.array(
    [
    0.1,
    0.45401,
    1.09765,
    1.27936,
    2.20611,
    2.50064,
    3.0403,
    3.23583,
    4.45308,
    4.1699,
    5.28474,
    5.59238,
    5.92091,
    6.66066,
    6.79953,
    7.97943,
    8.41536,
    8.71607,
    8.70156,
    9.16463,
    14
]
)

a = a[:, np.newaxis]

a = add_constant(a)

xm = np.mat(a)

# 将对角线元素取出, 即为观测值的帽子量
np.diagonal((xm * (xm.T* xm).I * xm.T))

array([0.15348107, 0.13936727, 0.1162922 , 0.11038166, 0.0843737 ,
       0.07755662, 0.06687867, 0.06358871, 0.0500325 , 0.05212105,
       0.04763236, 0.04815593, 0.04955668, 0.05589305, 0.05757389,
       0.07812097, 0.08854887, 0.09663419, 0.09622734, 0.11004824,
       0.35753503])
</code></pre>
<pre><code class="language-python">h = np.diagonal((xm * (xm.T* xm).I * xm.T))

h[h &gt; (2 * 2 / 20)]

array([0.35753503])
</code></pre>
<ul>
<li><a href="https://baike.baidu.com/item/%E5%B8%BD%E5%AD%90%E7%9F%A9%E9%99%A3/19112758">帽子矩阵_百度百科 (baidu.com)</a></li>
<li><a href="https://zhuanlan.zhihu.com/p/342282929">【投影模型01】从投影看线性回归 - 知乎 (zhihu.com)</a></li>
</ul>
<h3 id="23-强影响点">2.3 强影响点</h3>
<p><code>Influential Point</code>, 对模型有较大影响的点 如果删除该点能<strong>改变</strong>拟合回归方程.</p>
<blockquote>
<p>强影响点 即对模型参数估计值影响有些比例失衡的点. 例如 若移除模型的一个观测点时模型会发生巨大的改变 那么你就需要检测一下数据中是否存在强影响点了. 有两种方法可以检测强影响点: Cook距离 或称D统计量 以及变量添加图( added variableplot) . 一般来说 Cook’s D值大于<code>4/(n–k–1)</code> 则表明它是强影响点 其中n为样本量大小 k是预测变量数目.</p>
<p>&lt; R语言实战&gt;, 第二版</p>
</blockquote>
<pre><code class="language-bash">Row	x	    y
1	0.1	    -0.0716
2	0.45401	4.1673
3	1.09765	6.5703
4	1.27936	13.815
5	2.20611	11.4501
6	2.50064	12.9554
7	3.0403	20.1575
8	3.23583	17.5633
9	4.45308	26.0317
10	4.1699	22.7573
11	5.28474	26.303
12	5.59238	30.6885
13	5.92091	33.9402
14	6.66066	30.9228
15	6.79953	34.11
16	7.97943	44.4536
17	8.41536	46.5022
18	8.71607	50.0568
19	8.70156	46.5475
20	9.16463	45.7762
21	13	    15
</code></pre>
<figure data-type="image" tabindex="4"><a href="https://imgse.com/i/p9T1jc8"><img src="https://s1.ax1x.com/2023/05/23/p9T1jc8.png" alt="p9T1jc8.png" loading="lazy"></a></figure>
<p><strong>未剔除:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.742932</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.551948</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.528366</td>
</tr>
<tr>
<td>标准误差</td>
<td>10.44593</td>
</tr>
<tr>
<td>观测值</td>
<td>21</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>2553.978</td>
<td>2553.978</td>
<td>23.40576</td>
<td>0.000114</td>
</tr>
<tr>
<td>残差</td>
<td>19</td>
<td>2073.233</td>
<td>109.1175</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>20</td>
<td>4627.211</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>8.50455</td>
<td>4.222417</td>
<td>2.014143</td>
<td>0.058374</td>
<td>-0.33307</td>
<td>17.34217</td>
<td>-0.33307</td>
<td>17.34217</td>
</tr>
<tr>
<td>X Variable 1</td>
<td>3.319798</td>
<td>0.686199</td>
<td>4.83795</td>
<td>0.000114</td>
<td>1.883566</td>
<td>4.756029</td>
<td>1.883566</td>
<td>4.756029</td>
</tr>
</tbody>
</table>
<p><strong>剔除后:</strong></p>
<table>
<thead>
<tr>
<th>Multiple R</th>
<th>0.986493</th>
</tr>
</thead>
<tbody>
<tr>
<td>R Square</td>
<td>0.973168</td>
</tr>
<tr>
<td>Adjusted R Square</td>
<td>0.971677</td>
</tr>
<tr>
<td>标准误差</td>
<td>2.591988</td>
</tr>
<tr>
<td>观测值</td>
<td>20</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>df</th>
<th>SS</th>
<th>MS</th>
<th>F</th>
<th>Significance F</th>
</tr>
</thead>
<tbody>
<tr>
<td>回归分析</td>
<td>1</td>
<td>4386.068</td>
<td>4386.068</td>
<td>652.8441</td>
<td>1.35E-15</td>
</tr>
<tr>
<td>残差</td>
<td>18</td>
<td>120.9312</td>
<td>6.7184</td>
<td></td>
<td></td>
</tr>
<tr>
<td>总计</td>
<td>19</td>
<td>4506.999</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th>Coefficients</th>
<th>标准误差</th>
<th>t Stat</th>
<th>P-value</th>
<th>Lower 95%</th>
<th>Upper 95%</th>
<th>下限 95.0%</th>
<th>上限 95.0%</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Intercept</td>
<td>1.732178</td>
<td>1.120518</td>
<td>1.545873</td>
<td>0.139536</td>
<td>-0.62194</td>
<td>4.086298</td>
<td>-0.62194</td>
<td>4.086298</td>
<td></td>
</tr>
<tr>
<td>X Variable 1</td>
<td>5.116869</td>
<td>0.200262</td>
<td>25.55081</td>
<td>1.35E-15</td>
<td>4.696133</td>
<td>5.537605</td>
<td>4.696133</td>
<td>5.537605</td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>COO_1</th>
<th>LEV_1</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.08172</td>
<td>0.11134</td>
</tr>
<tr>
<td>0.03076</td>
<td>0.09637</td>
</tr>
<tr>
<td>0.02198</td>
<td>0.0719</td>
</tr>
<tr>
<td>0.00075</td>
<td>0.06564</td>
</tr>
<tr>
<td>0.00901</td>
<td>0.03815</td>
</tr>
<tr>
<td>0.00629</td>
<td>0.03097</td>
</tr>
<tr>
<td>0.00086</td>
<td>0.01975</td>
</tr>
<tr>
<td>0.00095</td>
<td>0.0163</td>
</tr>
<tr>
<td>0.00191</td>
<td>0.00228</td>
</tr>
<tr>
<td>0.00004</td>
<td>0.0044</td>
</tr>
<tr>
<td>0.00002</td>
<td>0.00005</td>
</tr>
<tr>
<td>0.0032</td>
<td>0.00074</td>
</tr>
<tr>
<td>0.00848</td>
<td>0.00237</td>
</tr>
<tr>
<td>0.00003</td>
<td>0.00947</td>
</tr>
<tr>
<td>0.0028</td>
<td>0.01132</td>
</tr>
<tr>
<td>0.03958</td>
<td>0.03383</td>
</tr>
<tr>
<td>0.05229</td>
<td>0.04518</td>
</tr>
<tr>
<td>0.0918</td>
<td>0.05397</td>
</tr>
<tr>
<td>0.04809</td>
<td>0.05353</td>
</tr>
<tr>
<td>0.03194</td>
<td>0.06853</td>
</tr>
<tr>
<td>4.04801</td>
<td>0.26391</td>
</tr>
</tbody>
</table>
<p>从上面的内容看, 删除异常点前后, 所有关键指标均发生变化, 基本等同于两个不同的模型.</p>
<h4 id="231-cook距离计算">2.3.1 cook距离计算</h4>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>D</mi><mi>i</mi></msub><mo>=</mo><mfrac><mrow><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent="true"><msub><mi>y</mi><mi>i</mi></msub><mo>^</mo></mover><msup><mo>)</mo><mn>2</mn></msup></mrow><mrow><mo>(</mo><mi>m</mi><mo>+</mo><mn>1</mn><mo>)</mo><msup><mi>s</mi><mn>2</mn></msup></mrow></mfrac><mfrac><msub><mi>h</mi><mi>i</mi></msub><mrow><mo>(</mo><mn>1</mn><mo>−</mo><msub><mi>h</mi><mi>i</mi></msub><msup><mo>)</mo><mn>2</mn></msup></mrow></mfrac><mspace linebreak="newline"></mspace><mi>m</mi><mo separator="true">,</mo><mi mathvariant="normal">为</mi><mi mathvariant="normal">自</mi><mi mathvariant="normal">变</mi><mi mathvariant="normal">量</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">量</mi><mo separator="true">,</mo><mi mathvariant="normal">一</mi><mi mathvariant="normal">元</mi><mi mathvariant="normal">线</mi><mi mathvariant="normal">性</mi><mo separator="true">,</mo><mi>m</mi><mo>=</mo><mn>1...</mn><mi mathvariant="normal">如</mi><mi mathvariant="normal">此</mi></mrow><annotation encoding="application/x-tex">D_i= \frac{(y_i - \hat{y_i}) ^ 2}{(m + 1)s^2}\frac{h_i}{(1 - h_i)^2}\\
m, 为自变量的数量, 一元线性, m = 1...如此
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.427108em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">自</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">量</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">元</span><span class="mord cjk_fallback">线</span><span class="mord cjk_fallback">性</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord cjk_fallback">如</span><span class="mord cjk_fallback">此</span></span></span></span></span></p>
<p>有趣的是这里的计算, <code>spss</code>使用的帽子矩阵方式计算的杠杆值, 而不是它自己给出的杠杆值, 实在无厘头.</p>
<table>
<thead>
<tr>
<th>y_e</th>
<th>COO_1</th>
<th>LEV_1</th>
<th>hand_cook</th>
<th>new_lev</th>
</tr>
</thead>
<tbody>
<tr>
<td>-8.90813</td>
<td>0.08172</td>
<td>0.11134</td>
<td>0.081715</td>
<td>0.158959</td>
</tr>
<tr>
<td>-5.84447</td>
<td>0.03076</td>
<td>0.09637</td>
<td>0.030756</td>
<td>0.143989</td>
</tr>
<tr>
<td>-5.57823</td>
<td>0.02198</td>
<td>0.0719</td>
<td>0.021982</td>
<td>0.119519</td>
</tr>
<tr>
<td>1.063233</td>
<td>0.00075</td>
<td>0.06564</td>
<td>0.000746</td>
<td>0.113259</td>
</tr>
<tr>
<td>-4.37829</td>
<td>0.00901</td>
<td>0.03815</td>
<td>0.009014</td>
<td>0.085769</td>
</tr>
<tr>
<td>-3.85077</td>
<td>0.00629</td>
<td>0.03097</td>
<td>0.00629</td>
<td>0.078589</td>
</tr>
<tr>
<td>1.559769</td>
<td>0.00086</td>
<td>0.01975</td>
<td>0.000863</td>
<td>0.067369</td>
</tr>
<tr>
<td>-1.68355</td>
<td>0.00095</td>
<td>0.0163</td>
<td>0.000947</td>
<td>0.063919</td>
</tr>
<tr>
<td>2.743825</td>
<td>0.00191</td>
<td>0.00228</td>
<td>0.001907</td>
<td>0.049899</td>
</tr>
<tr>
<td>0.409525</td>
<td>0.00004</td>
<td>0.0044</td>
<td>4.45E-05</td>
<td>0.052019</td>
</tr>
<tr>
<td>0.254181</td>
<td>0.00002</td>
<td>0.00005</td>
<td>1.56E-05</td>
<td>0.047669</td>
</tr>
<tr>
<td>3.618379</td>
<td>0.0032</td>
<td>0.00074</td>
<td>0.003204</td>
<td>0.048359</td>
</tr>
<tr>
<td>5.779426</td>
<td>0.00848</td>
<td>0.00237</td>
<td>0.008477</td>
<td>0.049989</td>
</tr>
<tr>
<td>0.306205</td>
<td>0.00003</td>
<td>0.00947</td>
<td>2.76E-05</td>
<td>0.057089</td>
</tr>
<tr>
<td>3.032385</td>
<td>0.0028</td>
<td>0.01132</td>
<td>0.002804</td>
<td>0.058939</td>
</tr>
<tr>
<td>9.458956</td>
<td>0.03958</td>
<td>0.03383</td>
<td>0.039577</td>
<td>0.081449</td>
</tr>
<tr>
<td>10.06036</td>
<td>0.05229</td>
<td>0.04518</td>
<td>0.052292</td>
<td>0.092799</td>
</tr>
<tr>
<td>12.61666</td>
<td>0.0918</td>
<td>0.05397</td>
<td>0.091804</td>
<td>0.101589</td>
</tr>
<tr>
<td>9.15553</td>
<td>0.04809</td>
<td>0.05353</td>
<td>0.048087</td>
<td>0.101149</td>
</tr>
<tr>
<td>6.846931</td>
<td>0.03194</td>
<td>0.06853</td>
<td>0.031939</td>
<td>0.116149</td>
</tr>
<tr>
<td>-36.6619</td>
<td>4.04801</td>
<td>0.26391</td>
<td>4.047933</td>
<td>0.311529</td>
</tr>
</tbody>
</table>
<pre><code class="language-bash">hand_cook = y_e/2/标准误差^2 * new_lev/(1- new_lev)^2

# new_lev, 恢复原来的杠杆值
</code></pre>
<blockquote>
<p>通过图形可以判断Alaska Hawaii和Nevada是强影响点. 若删除这些点 将会导致回归模型截距项和斜率发生显著变化. 注意 虽然该图对搜寻强影响点很有用 但我逐渐发现以1为分割点比4/(n–k–1)更具一般性. 若设定D=1为判别标准 则数据集中没有点看起来像是强影响点.</p>
<p>&lt; R语言实战 &gt;</p>
</blockquote>
<blockquote>
<p>确定某一观察点是否具有影响的经验规则是其库克距离超过1.0. 更精确地说 也可以比较库克距离与具有( m n-m-1) 自由度的 F F<em>F</em> 分布的百分位数. 如果观察值位于该分布的第1个四分之一位( 低于25%)  则观察点对回归的影响较小. 如果库克距离大于该分布的中位数 则该观察点具有一定的影响.</p>
<p><a href="https://blog.csdn.net/qq_40891541/article/details/90475123">15 离群点和高杠杆率点_库克距离_纸境止境的博客-CSDN博客</a></p>
</blockquote>
<h3 id="24-小结">2.4 小结</h3>
<ul>
<li>异常点不一定是强影响点 强影响点也不一定是异常点.</li>
<li>高杠杆点不一定是强影响点 强影响点也不一定是高杠杆点.</li>
</ul>
<h3 id="25-异常的处理">2.5 异常的处理</h3>
<ul>
<li>
<p>删除异常观测点.</p>
<blockquote>
<p>删除离群点通常可以提高数据集对于正态假设的拟合度 而强影响点会干扰结果 通常也会被删除. 删除最大的离群点或者强影响点后 模型需要重新拟合. 若离群点或强影响点仍然存在 重复以上过程直至获得比较满意的拟合. 我对删除观测点持谨慎态度. 若是因为数据记录错误 或是没有遵守规程 或是受试对象误解了指导说明 这种情况下的点可以判断为离群点 删除它们是十分合理的.</p>
<p>不过在其他情况下 所收集数据中的异常点可能是最有趣的东西. 发掘为何该观测点不同于其他点 有助于你更深刻地理解研究的主题 或者发现其他你可能没有想过的问题. 我们一些最伟大的进步正是源自于意外地发现了那些不符合我们先验认知的东西( 抱歉 我说得夸张了) .</p>
</blockquote>
<p>简而言之, 删除异常点需谨慎, 查找异常的来源也是对数据很好的探索方式之一.</p>
</li>
<li>
<p>变量变换, 相对常见的就是<code>Box-Cox正态变换</code>, 让数据更趋向于满足正态分布.</p>
</li>
<li>
<p>添加变量或者删除变量(注意是变量, 不是观测点, 变量, 列)</p>
</li>
<li>
<p>使用其他的回归方法</p>
</li>
</ul>
<h2 id="三-参考">三. 参考</h2>
<ul>
<li>&lt; R语言实战 &gt;, 第二版</li>
<li><a href="https://online.stat.psu.edu/stat501/lesson/11/11.2">11.2 - Using Leverages to Help Identify Extreme x Values | STAT 501 (psu.edu)</a></li>
<li><a href="https://support.minitab.com/zh-cn/minitab/20/help-and-how-to/statistical-modeling/regression/how-to/fit-regression-model/methods-and-formulas/diagnostic-measures/">拟合回归模型中诊断度量标准的方法和公式 - Minitab</a></li>
<li><a href="https://online.stat.psu.edu/stat462/node/170/">9.1 - Distinction Between Outliers and High Leverage Observations | STAT 462 (psu.edu)</a></li>
<li><a href="https://blog.csdn.net/Android_xue/article/details/97614045">第七章线性回归预测模型_SunnyRivers的博客-CSDN博客</a></li>
</ul>

            </div>
            
            
              <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong class="language" data-lan="author">本文作者：</strong>
      Lian
    </li>
    <li class="post-copyright-link">
      <strong class="language" data-lan="link">本文链接：</strong>
      <a href="https://Kyouichirou.github.io/post/xian-xing-hui-gui-yi-chang/" title="线性回归 - 异常">https://Kyouichirou.github.io/post/xian-xing-hui-gui-yi-chang/</a>
    </li>
    <li class="post-copyright-license">
      <strong class="language" data-lan="copyright">版权声明： </strong>
      本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://Kyouichirou.github.io/tag/Q2P6FXAzPd/"># spss</a>
    
      <a href="https://Kyouichirou.github.io/tag/bxmmKSW1O/"># math</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="地址拆分-Excel公式执行循环操作" href="https://Kyouichirou.github.io/post/di-zhi-chai-fen-excel-gong-shi-zhi-xing-xun-huan-cao-zuo/">地址拆分-Excel公式执行循环操作</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="地址拆分-Excel公式执行循环操作" href="https://Kyouichirou.github.io/post/di-zhi-chai-fen-excel-gong-shi-zhi-xing-xun-huan-cao-zuo/">上一篇</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="2022 Kaggle Data Science &amp; ML Survey" href="https://Kyouichirou.github.io/post/2022-kaggle-data-science-and-ml-survey/">2022 Kaggle Data Science &amp; ML Survey</a>
        <a class="nav-mobile-next" title="2022 Kaggle Data Science &amp; ML Survey" href="https://Kyouichirou.github.io/post/2022-kaggle-data-science-and-ml-survey/">下一篇</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
            
            
  

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <center id="runTimeBox">
      已运行:<span id="run_time"></span>
    </center>
    <span id="busuanzi_container_site_pv">浏览数:<span id="busuanzi_value_site_pv"></span> 次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">访客数:<span id="busuanzi_value_site_uv"></span> 人</span>

    <script>
      BirthDay = new Date('');
      if (BirthDay.getTime()) {
        function runTime() {
          str = "";
          today = new Date();
          timeold = today.getTime() - BirthDay.getTime();
          msPerDay = 24 * 60 * 60 * 1000;
          e_daysold = timeold / msPerDay;
          daysold = Math.floor(e_daysold);
          str += daysold + "天";
          return str;
        }
        setInterval(function () {
          $("#run_time").html(runTime());
        }, 1000);
      } else {
        document.querySelector('.footer').removeChild(document.querySelector('#runTimeBox'));
      }
    </script>
    <div class="poweredby">
      Powered by <a href="https://github.com/Kyouichirou" target="_blank">Kyouichirou</a>
    </div>
  </footer>
  
    
      <div class="drawer-box left" id="drawer_box">
        <span class="muse-line muse-line-first"></span>
        <span class="muse-line muse-line-middle"></span>
        <span class="muse-line muse-line-last"></span>
      </div>
      
        <div class="mist back-to-top" id="back_to_top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
        
          
            
              <div class="bg-img">
                <img src="https://s1.ax1x.com/2023/03/24/ppBNvm6.jpg" />
              </div>
              
                
                  
                        
</div>
<script>
  let sideBarOpen = "sidebar-open";
  let body = document.body;
  let back2Top = document.querySelector("#back_to_top"),
    back2TopText = document.querySelector("#back_to_top_text"),
    drawerBox = document.querySelector("#drawer_box"),
    rightSideBar = document.querySelector(".sidebar"),
    viewport = document.querySelector("body");

  function scrollAnimation(currentY, targetY) {
    let needScrollTop = targetY - currentY;
    let _currentY = currentY;
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10);
      _currentY += dist;
      window.scrollTo(_currentY, currentY);
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY);
      } else {
        window.scrollTo(_currentY, targetY);
      }
    }, 1);
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener("scroll", function (e) {
    let percent =
      (document.scrollingElement.scrollTop /
        (document.scrollingElement.scrollHeight -
          document.scrollingElement.clientHeight)) *
      100;
    if (percent > 1 && !back2Top.classList.contains("back-top-active")) {
      back2Top.classList.add("back-top-active");
    }
    if (percent == 0) {
      back2Top.classList.remove("back-top-active");
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  let hasCacu = false;
  window.addEventListener("resize", function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // 动态调整站点概览高度
    if (
      (!hasCacu && back2Top.classList.contains("pisces")) ||
      back2Top.classList.contains("gemini")
    ) {
      let sideBar = document.querySelector(".sidebar");
      let navUl = document.querySelector("#site_nav");
      sideBar.style =
        "margin-top:" + (navUl.offsetHeight + navUl.offsetTop + 15) + "px;";
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false,
    MOTION_TIME = 300,
    RIGHT_MOVE_DIS = "320px";

  if (drawerBox) {
    let rightMotions = document.querySelectorAll(".right-motion");
    let right = drawerBox.classList.contains("right");

    let transitionDir = right
      ? "transition.slideRightIn"
      : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingRight: "0px",
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingLeft: "0px",
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, "stop");
      jQuery.Velocity(viewport, "stop");
      jQuery.Velocity(rightMotions, "stop");
      if (open) {
        jQuery.Velocity(
          rightSideBar,
          {
            width: RIGHT_MOVE_DIS,
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, transitionDir, {});
            },
          }
        );
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME,
        });
      } else {
        jQuery.Velocity(
          rightSideBar,
          {
            width: "0px",
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, {
                opacity: 0,
              });
            },
          }
        );
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME,
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle("muse-line");
      }
      drawerBox.classList.toggle(sideBarOpen);
    };
  }

  // 链接跳转
  let newWindow = "false";
  if (newWindow === "true") {
    let links = document.querySelectorAll(".post-body a");
    links.forEach((item) => {
      if (!item.classList.contains("btn")) {
        item.setAttribute("target", "_blank");
      }
    });
  }

  let faSearch = document.querySelector("#fa_search");
  faSearch &&
    faSearch.addEventListener("click", function () {
      document.querySelector("#search_mask").style = "";
    });

  // 代码高亮
  hljs.initHighlightingOnLoad();

  // 离开当前页title变化
  var leaveTitle = "";
  var normal_title = document.title;
  if (leaveTitle) {
    document.addEventListener("visibilitychange", function () {
      if (document.visibilityState == "hidden") {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }
</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll(".section img");
  images.forEach((image) => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement("a");
    aelem.href = image.src;
    aelem.dataset["fancybox"] = "images";
    aelem.dataset["rel"] = "fancybox-button";
    aelem.classList.add("fancybox");
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  });
</script>
    <div class="reward-mask" style="display: none;">
  <div class="reward-relative">
    <span class="close" aria-hidden="true">x</span>
    <div class="reward-body">
      <h2>感谢您的支持，我会继续努力的!</h2>
      <div class="reward-img-box">
        <div style="position: relative; width: 140px; height: 140px;">
          
          
          
        </div>
      </div>
      <p class="reward-word">扫码打赏，你说多少就多少</p>
      <p class="reward-tip"> </p>
    </div>
    <div class="bottom">
      
      
    </div>
  </div>
</div>
<style>
  .reward-mask {
    position: fixed;
    z-index: 99999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #00000054;
  }

  .reward-relative {
    position: relative;
    width: 480px;
    text-align: center;
    margin: 0 auto;
    border-radius: 5px;
    background-color: #fff;
    top: 50%;
    margin-top: -205px;
  }

  .reward-relative .close {
    position: absolute;
    right: 10px;
    font-weight: normal;
    font-size: 16px;
    color: #929292;
  }

  .reward-body {
    padding: 40px 20px 20px;
  }

  .bottom {
    display: flex;
  }

  .reward-btn {
    text-align: center;
  }

  .reward-btn-text {
    display: inline-block;
    cursor: pointer;
    width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 50%;
    background-color: #ff9734;
    color: #FFF;
    margin-top: 20px;
  }

  .pay-text {
    margin-top: 10px;
    padding: 10px;
    flex: 1;
    transition: all .2s linear;
  }

  .pay-text:hover {
    background-color: #a5a5a536;
  }

  .reward-body h2 {
    padding-top: 10px;
    text-align: center;
    color: #a3a3a3;
    font-size: 16px;
    font-weight: normal;
    margin: 0 0 20px;
  }

  .reward-body h2:after,
  .reward-body h2:before {
    font-family: Arial, Helvetica, sans-serif;
    background: 0 0;
    width: 0;
    height: 0;
    font-style: normal;
    color: #eee;
    font-size: 80px;
    position: absolute;
    top: 20px;
  }

  .reward-body h2:before {
    content: '\201c';
    left: 50px;
  }

  .reward-body h2:after {
    content: '\201d';
    right: 80px;
  }

  .reward-img-box {
    display: inline-block;
    padding: 10px;
    border: 6px solid #ea5f00;
    margin: 0 auto;
    border-radius: 3px;
    position: relative;
  }

  .reward-img {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }

  @media (max-width: 767px) {
    .reward-relative {
      height: 100%;
      top: 0px;
      margin-top: 0;
      width: auto;
    }

    .reward-relative .bottom {
      flex-direction: column;
    }

    .reward-relative .pay-text {
      width: 80%;
      margin: 5px auto;
      border: 1px solid silver;
      padding: 6px;
      border-radius: 4px;
    }

    .reward-body h2:after {
      right: 40px;
    }

    .reward-body h2:after,
    .reward-body h2:before {
      font-size: 60px;
    }

    .reward-body h2:before {
      left: 20px;
    }
  }
</style>
<script>
  !function () {
    var mask = document.querySelector('.reward-mask');
    let close = document.querySelector('.reward-relative .close');
    let rewardBtn = document.querySelector('.reward-btn');

    let zfb = document.querySelector('#zfb'),
      wx = document.querySelector('#wx'),
      zfbBtn = document.querySelector('#zfbBtn'),
      wxBtn = document.querySelector('#wxBtn');

    if (zfbBtn && wxBtn) {
      zfbBtn.addEventListener('click', () => {
        jQuery.Velocity(zfb, 'transition.slideLeftIn', {
          duration: 400
        });
        jQuery.Velocity(wx, 'transition.slideRightOut', {
          display: 'none',
          duration: 400
        });
      });

      wxBtn.addEventListener('click', () => {
        jQuery.Velocity(wx, 'transition.slideRightIn', {
          duration: 400
        });
        jQuery.Velocity(zfb, 'transition.slideLeftOut', {
          display: 'none',
          duration: 400
        });
      });
    }

    rewardBtn && rewardBtn.addEventListener('click', (e) => {
      jQuery.Velocity(mask, 'transition.slideDownIn', {
        duration: 400
      })
    });

    close.addEventListener('click', (e) => {
      e.preventDefault();
      jQuery.Velocity(mask, 'transition.slideUpOut', {
        duration: 400
      })
    })
  }()
</script>

  </div>
</body>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + '秒之前';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + '分钟之前';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + '小时之前';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + '天之前';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = 'en';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }

  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // 判断是不是ios端
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //创建文本元素
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //选择内容
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //复制到剪贴板
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("复制错误！请手动复制！")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === '复制成功') {
        return;
      }
      e.srcElement.textContent = '复制成功';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === '复制成功') {
            elem.textContent = '复制代码'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = '复制代码';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


  <script
    src="https://cdn.staticfile.org/smooth-scroll/16.1.3/smooth-scroll.polyfills.min.js"></script>
  <script>
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 200
    });
  </script>






  <div class="snow-container"></div>
  <script src="/media/js/bg/snow.js"></script>

</html>