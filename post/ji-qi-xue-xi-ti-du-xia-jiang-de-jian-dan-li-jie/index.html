<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="keywords" content="Lian个人博客-数据与思考">
<meta name="description" content="Make Thing Better and Simpler">
<meta name="theme-color" content="#000">
<title>机器学习-梯度下降的简单理解 | Lian</title>
<link rel="shortcut icon" href="/favicon.ico?v=1758516680740">
<link rel="stylesheet" href="/media/css/mist.css">
<link rel="stylesheet" href="/media/fonts/font-awesome.css">
<link
  href="//fonts.loli.net/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Rosario:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext"
  rel="stylesheet" type="text/css">

<link href="/media/hljs/styles/tomorrow-night.css"
  rel="stylesheet">

<link rel="stylesheet" href="/styles/main.css">
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/media/js/jquery.js"></script>
<script src="/media/hljs/highlight.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbnet.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbscript-html.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/vbscript.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.0/languages/sql.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/velocity/1.5.1/velocity.min.js"></script>
<script src="https://cdn.bootcdn.net/ajax/libs/velocity/1.5.1/velocity.ui.min.js"></script>
<link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/KaTeX/0.11.1/katex.min.css"
  integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">


<script>
  window.MathJax = {
    tex: {
      inlineMath: [['$', '$'], ["\\(", "\\)"]],
      displayMath: [['$$', '$$'], ["\\[", "\\]"]]
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'a', 'annotation', 'annotation-xml'],
      ignoreHtmlClass: 'tex2jax_ignore|crayon-.*', // 'crayon-' 开头的类，属于Wordpress代码高亮库，这部分不需要处理，否则会导致显示不正确,这部分是正则式，多条之间用'|'分割
      processHtmlClass: 'tex2jax_process'
    },
    //禁用右键菜单	
    renderActions: {
      addMenu: [0, '', '']
    }
  };
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>




<script>
  var _hmt = _hmt || [];
  (function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?19bd452dc174a21cc99fb66ddfcef0cc";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>



  <meta name="description" content="机器学习-梯度下降的简单理解" />
  <meta name="keywords" content="math,machine learning" />
</head>

<body>
  <div class="head-top-line"></div>
  <div class="header-box">
    
<div class="mist">
  <header class="header bg-color ">
    <div class="blog-header box-shadow-wrapper  " id="header">
      <div class="nav-toggle" id="nav_toggle">
        <div class="toggle-box">
          <div class="line line-top"></div>
          <div class="line line-center"></div>
          <div class="line line-bottom"></div>
        </div>
      </div>
      <div class="site-meta">       
        <div class="site-title">
          
            <a href="/" class="">
              <span class="logo-line-before">
                <i class=""></i>
              </span>
              <span class="main-title">Lian</span>
              <span class="logo-line-after">
                <i class=""></i>
              </span>
            </a>  
          
        </div>
        
      </div>
      <nav class="site-nav" id="site_nav">
        <ul id="nav_ul">
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/" target="_self">
                  <i class="fa fa-globe"></i> Home
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/archives" target="_self">
                  <i class="fa fa-globe"></i> Archives
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="/tags" target="_self">
                  <i class="fa fa-globe"></i> Tags
                </a>
              
            </li>
          
            
            
              
            
            <li class="nav-item ">
              
              
                <a href="https://Kyouichirou.github.io/post/about-me" target="_self">
                  <i class="fa fa-globe"></i> About
                </a>
              
            </li>
          
          
            
              <li class="nav-item ">
                <a href="/friends/" target="_self">
                  
                    <i class="fa fa-github"></i> GitHub
                  
                </a>
              </li>
            
          
          
        </ul>
      </nav>
    </div>
  </header>
</div>

<script type="text/javascript"> 
 
  let showNav = true;

  let navToggle = document.querySelector('#nav_toggle'),
  siteNav = document.querySelector('#site_nav');
  
  function navClick() {
    let sideBar = document.querySelector('.sidebar');
    let navUl = document.querySelector('#nav_ul');
    navToggle.classList.toggle('nav-toggle-active');
    siteNav.classList.toggle('nav-menu-active');
    if (siteNav.classList.contains('nav-menu-active')) {
      siteNav.style = "height: " + (navUl.children.length * 42) +"px !important";
    } else {
      siteNav.style = "";
    }
  }

  navToggle.addEventListener('click',navClick);  
</script>
  </div>
  <div class="main-continer">
    
    <div
      class="section-layout mist bg-color">
      <div class="section-layout-wrapper">
        

<div class="sidebar">
  
    <div class="sidebar-box box-shadow-wrapper  right-motion" id="sidebar">
      
        <div class="post-list-sidebar">
          <div class="sidebar-title">
            <span id="tocSideBar" class="sidebar-title-item sidebar-title-active language" data-lan="index">文章目录</span>
            <span id="metaSideBar" class="sidebar-title-item language" data-lan="preview">站点概览</span>
          </div>
        </div>
      
      <div class="sidebar-body mist" id="sidebar_body">
        
          
            <div class="post-side-meta" id="post_side_meta">
              
<div class="sidebar-wrapper box-shadow-wrapper ">
  <div class="sidebar-item">
    <img class="site-author-image right-motion" src="/images/avatar.png"/>
    <p class="site-author-name">Lian</p>
    
    <div class="site-description right-motion">
      
      
      
        <p>make thing better and simpler.</p>
      
      
    </div>
    
  </div>
  <div class="sidebar-item side-item-stat right-motion">
    <div class="sidebar-item-box">
      <a href="/archives/">
        
        <span class="site-item-stat-count">103</span>
        <span class="site-item-stat-name language" data-lan="article">文章</span>
      </a>
    </div>
    <div class="sidebar-item-box">
      <a href="/tags/">
        <span class="site-item-stat-count">64</span>
        <span class="site-item-stat-name language" data-lan="tag">标签</span>
      </a>
    </div>
  </div>
  
  



</div>
            </div>
            <div class="post-toc sidebar-body-active" id="post_toc" style="opacity: 1;">
              <div class="toc-box right-motion">
  <div class="toc-wrapper  auto"
    id="toc_wrapper">
    <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E4%B8%80-%E5%89%8D%E8%A8%80">一. 前言</a>
<ul>
<li><a href="#11-%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D">1.1 梯度下降</a></li>
<li><a href="#12-%E7%AE%80%E5%8D%95%E6%95%B0%E5%AD%A6%E6%8E%A8%E5%AF%BC">1.2 简单数学推导</a></li>
</ul>
</li>
<li><a href="#%E4%BA%8C-%E6%96%87%E7%AB%A0%E4%BB%A3%E7%A0%81">二. 文章代码</a>
<ul>
<li><a href="#21-%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90">2.1 代码解析</a></li>
<li><a href="#22-%E6%A2%AF%E5%BA%A6%E6%98%AF%E4%BB%80%E4%B9%88">2.2 梯度是什么?</a></li>
</ul>
</li>
<li><a href="#%E4%B8%89-%E7%AE%80%E5%8D%95%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0">三. 简单代码实现</a></li>
<li><a href="#%E5%9B%9B-%E5%85%B6%E4%BB%96%E6%8B%9F%E5%90%88%E6%96%B9%E5%BC%8F">四. 其他拟合方式</a></li>
<li><a href="#%E4%BA%94-%E5%B0%8F%E7%BB%93">五. 小结</a>
<ul>
<li><a href="#51-%E5%9B%9E%E9%A1%BE">5.1 回顾</a></li>
</ul>
</li>
<li><a href="#%E5%85%AD-%E5%8F%82%E8%80%83">六. 参考</a></li>
</ul>
</li>
</ul>

  </div>
</div>

<script>

  let lastTop = 0, lList = [], hList = [], postBody, lastIndex = -1;
  let active = 'active-show', activeClass = 'active-current';
  let tocWrapper = document.querySelector('#toc_wrapper');
  let tocContent = tocWrapper.children[0];
  let autoNumber = tocWrapper && tocWrapper.classList.contains('auto-number');

  function addTocNumber(elem, deep) {
    if (!elem) {
      return;
    }
    let prop = elem.__proto__;

    if (prop === HTMLUListElement.prototype) {
      for (let i = 0; i < elem.children.length; i++) {
        addTocNumber(elem.children[i], deep + (i + 1) + '.');
      }
    } else if (prop === HTMLLIElement.prototype) {
      // 保存li元素
      if (elem.children[0] && elem.children[0].__proto__ === HTMLAnchorElement.prototype) {
        lList.push(elem);
      }
      for (let i = 0; i < elem.children.length; i++) {
        let cur = elem.children[i];
        if (cur.__proto__ === HTMLAnchorElement.prototype) {
          if (autoNumber) {
            cur.text = deep + ' ' + cur.text;
          }
        } else if (cur.__proto__ === HTMLUListElement.prototype) {
          addTocNumber(cur, deep);
        }
      }
    }
  }

  function removeParentActiveClass() {
    let parents = tocContent.querySelectorAll('.' + active)
    parents.forEach(function (elem) {
      elem.classList.remove(active);
    });
  }

  function addActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.add(activeClass);
    }
  }

  function removeActiveClass(index) {
    if (index >= 0 && index < hList.length) {
      lList[index].classList.remove(activeClass);
    }
  }

  function addActiveLiElemment(elem, parent) {
    if (!elem || elem === parent) {
      return;
    } else {
      if (elem.__proto__ === HTMLLIElement.prototype) {
        elem.classList.add(active);
      }
      addActiveLiElemment(elem.parentElement, parent);
    }
  }

  function showToc() {
    if (tocWrapper) {
      postBody = document.querySelector('#post_body');
      for (let i = 0; i < postBody.children.length; i++) {
        if (postBody.children[i].__proto__ === HTMLHeadingElement.prototype) {
          hList.push(postBody.children[i]);
        }
      }
      if (tocWrapper.classList.contains('compress')) {
        tocContent.classList.add('closed');
      } else if (tocWrapper.classList.contains('no_compress')) {
        tocContent.classList.add('expanded');
      } else {
        if (hList.length > 10) {
          active = 'active-hidden'
          tocContent.classList.add('closed');
        } else {
          tocContent.classList.add('expanded');
        }
      }
    }
  }

  (function () {
    // 处理不是从#一级标题开始目录
    if (tocContent.children.length === 1 && tocContent.children[0].__proto__ === HTMLLIElement.prototype) {
      let con = tocContent.children[0].children[0];
      tocContent.innerHTML = con.innerHTML;
    }
    let markdownItTOC = document.querySelector('.markdownIt-TOC');
    let innerHeight = window.innerHeight;
    markdownItTOC.style = `max-height: ${innerHeight - 80 > 0 ? innerHeight - 80 : innerHeight}px`
    addTocNumber(tocContent, '');
  })();

  document.addEventListener('scroll', function (e) {
    if (lList.length <= 0) {
      return;
    }
    let scrollTop = document.scrollingElement.scrollTop + 10;
    let dir;

    if (lastTop - scrollTop > 0) {
      dir = 'up';
    } else {
      dir = 'down';
    }

    lastTop = scrollTop;
    if (scrollTop <= 0) {
      if (lastIndex >= 0 && lastIndex < hList.length) {
        lList[lastIndex].classList.remove(activeClass);
      }
      return;
    }

    let current = 0, hasFind = false;
    for (let i = 0; i < hList.length; i++) {
      if (hList[i].offsetTop > scrollTop) {
        current = i;
        hasFind = true;
        break;
      }
    }
    if (!hasFind && scrollTop > lList[lList.length - 1].offsetTop) {
      current = hList.length - 1;
    } else {
      current--;
    }
    if (dir === 'down') {
      if (current > lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex)
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    } else {
      if (current < lastIndex) {
        addActiveClass(current);
        removeActiveClass(lastIndex);
        lastIndex = current;
        removeParentActiveClass();
        lList[current] && addActiveLiElemment(lList[current].parentElement, tocContent);
      }
    }
  });


  window.addEventListener('load', function () {
    showToc();
    document.querySelector('#sidebar').style = 'display: block;';
    tocWrapper.classList.add('toc-active');
    setTimeout(function () {
      if ("createEvent" in document) {
        let evt = document.createEvent("HTMLEvents");
        evt.initEvent("scroll", false, true);
        document.dispatchEvent(evt);
      }
      else {
        document.fireEvent("scroll");
      }
    }, 500)
  })

</script>
            </div>
          
        
      </div>
    </div>
  
</div>
<script>
  const SIDEBAR_TITLE_ACTIVE = 'sidebar-title-active';
  const SIDEBAR_BODY_ACTIVE = 'sidebar-body-active';
  const SLIDE_UP_IN = 'slide-up-in';

  let sidebar = document.querySelector('#sidebar'),
  tocSideBar = document.querySelector('#tocSideBar'),
  metaSideBar = document.querySelector('#metaSideBar'),
  postToc = document.querySelector('#post_toc'),
  postSiteMeta = document.querySelector('#post_side_meta'),
  sidebarTitle = document.querySelector('.sidebar-title'),
  sidebarBody = document.querySelector('#sidebar_body');

  tocSideBar && tocSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  metaSideBar && metaSideBar.addEventListener('click', (e) => {
    toggleSidebar(e);
  });

  function toggleSidebar(e) {
    let currentTitle = document.querySelector("."+SIDEBAR_TITLE_ACTIVE);
    if (currentTitle == e.srcElement) {
      return ;
    }
    let current, showElement, hideElement;
    if (e.srcElement == metaSideBar) {
      showElement = postSiteMeta;
      hideElement = postToc;
    } else if (e.srcElement == tocSideBar){
      showElement = postToc;
      hideElement = postSiteMeta;
    }
    currentTitle.classList.remove(SIDEBAR_TITLE_ACTIVE);
    e.srcElement.classList.add(SIDEBAR_TITLE_ACTIVE);

    jQuery.Velocity(hideElement, 'stop');
    jQuery.Velocity(hideElement, 'transition.slideUpOut', {
      display: 'none',
      duration: 200,
      complete: function () {
        jQuery.Velocity(showElement, 'transition.slideDownIn', {
          duration: 200
        });
      }
    })
    hideElement.classList.remove(SIDEBAR_BODY_ACTIVE);
    showElement.classList.add(SIDEBAR_BODY_ACTIVE);
  }

  postToc && postToc.addEventListener('transitionend', function() {
    this.classList.remove(SLIDE_UP_IN);
  });

  if (sidebarBody) {
    if (sidebarBody.classList.contains('pisces') || sidebarBody.classList.contains('gemini')) {
      let hasFix = false;
      let scrollEl = document.querySelector('.main-continer');
      let limitTop = document.querySelector('#nav_ul').children.length * 42 + 162;
      window.addEventListener('scroll', function(e) {
        if (document.scrollingElement.scrollTop >= limitTop) {
          if (!hasFix) {
            sidebar.classList.add('sidebar-fixed');
            hasFix = true;
          }
        } else {
          if (hasFix) {
            sidebar.classList.remove('sidebar-fixed');
            hasFix = false;
          }
        }
      });
    }
  }
  
</script>
        <div class="section-box box-shadow-wrapper">
          <div class="section bg-color post post-page">
            <section class="post-header">
  <h1 class="post-title">
    <a class="post-title-link" href="https://Kyouichirou.github.io/post/ji-qi-xue-xi-ti-du-xia-jiang-de-jian-dan-li-jie/"> 机器学习-梯度下降的简单理解 </a>
  </h1>
  <div class="post-meta">
    
    <span class="meta-item pc-show">
      <i class="fa fa-calendar-o"></i>
      <span class="language" data-lan="publish">发布于</span>
      <span class="publish-time" data-t="2023-04-12 18:33:53">2023-04-12</span>
      <span class="post-meta-divider pc-show">|</span>
    </span>
    
    <span class="meta-item">
      <i class="fa fa-folder-o"></i>
      <span class="pc-show language" data-lan="category-in">标签:</span>
       
      <a href="https://Kyouichirou.github.io/tag/bxmmKSW1O/"> <span>math</span> </a>、   
      <a href="https://Kyouichirou.github.io/tag/w2qaY4U6Ss/">
        <span>machine learning</span>
      </a>
       
    </span>
    <span class="post-meta-divider">|</span>
    
    <span class="meta-item">
      <i class="fa fa-clock-o"></i>
      <span
        >28<span class="language" data-lan="minute"
          >分钟</span
        ></span
      >
    </span>
    <span class="meta-item">
      <span class="post-meta-divider">|</span>
      <i class="fa fa-file-word-o"></i>
      <span
        >5853<span class="pc-show language" data-lan="words"
          >字数</span
        ></span
      >
    </span>
    
  </div>
</section>

            <div class="post-body next-md-body" id="post_body">
              <h2 id="一-前言">一. 前言</h2>
<figure data-type="image" tabindex="1"><a href="https://imgse.com/i/ppbPbxe"><img src="https://s1.ax1x.com/2023/04/09/ppbPbxe.png" alt="ppbPbxe.png" loading="lazy"></a></figure>
<p>(<em>图: 豆瓣读书-复分析导论</em>)</p>
<p>在检索<code>算法, 模型, 高阶数学</code>等内容时常遇到的问题, 各种模棱两可, 似是而非的信息. 多查多看.</p>
<!--more-->
<h3 id="11-梯度下降">1.1 梯度下降</h3>
<blockquote>
<p>In mathematics, <strong>gradient descent</strong> (also often called <strong>steepest descent</strong>) is a <a href="https://en.wikipedia.org/wiki/Category:First_order_methods">first-order</a> <a href="https://en.wikipedia.org/wiki/Iterative_algorithm">iterative</a> <a href="https://en.wikipedia.org/wiki/Mathematical_optimization">optimization</a> <a href="https://en.wikipedia.org/wiki/Algorithm">algorithm</a> for finding a <a href="https://en.wikipedia.org/wiki/Local_minimum">local minimum</a> of a <a href="https://en.wikipedia.org/wiki/Differentiable_function">differentiable function</a></p>
<p>Wikipedia</p>
<ul>
<li>或称最速下降</li>
<li>为了在不同的函数中找到最小值</li>
</ul>
</blockquote>
<blockquote>
<p>梯度下降法是机器学习中一种常用到的算法 但其本身不是机器学习算法 而是一种求解的最优化算法. 主要解决求最小值问题 其基本思想在于不断地<strong>逼近</strong>最优点 每一步的优化方向就是梯度的方向.</p>
<p>zhihu</p>
</blockquote>
<blockquote>
<p>Gradient descent is an optimization algorithm which is commonly-used to train <a href="https://www.ibm.com/topics/machine-learning">machine learning</a> models and <a href="https://www.ibm.com/topics/neural-networks">neural networks</a>. Training data helps these models learn over time, and the <strong>cost function within gradient descent specifically acts as a barometer, gauging its accuracy with each iteration of parameter updates. Until the function is close to or equal to zero</strong>, the model will continue to adjust its parameters to yield the smallest possible error. Once machine learning models are optimized for accuracy, they can be powerful tools for artificial intelligence (AI) and computer science applications.</p>
<ul>
<li>常应用于训练机器学习模型和神经网络.</li>
</ul>
<p><a href="https://www.ibm.com/topics/gradient-descent">IBM</a></p>
</blockquote>
<iframe src="//player.bilibili.com/player.html?aid=891549064&bvid=BV18P4y1j7uH&cid=437149663&page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" width=720 height=480> </iframe>
<p>很多关于梯度下降介绍的文章或者视频, 多是基本问题没有说清楚, 抑或是使用一些不靠谱的例子来演示, 还有更多的是一味在搞数学公式的推导...简而言之, 简单的问题复杂化, 复杂问题表面化.</p>
<p>视频中, UP很好地以相对简单的方式原理将关于梯度下降的基本轮廓讲解明白, 但是没有实际的例子, 各种细节也没有提及, 还是有点朦胧, 在<code>csdn</code>找到一篇不错的文章, 包含了数学推导, 也有清晰完整的例子, 文章见: <a href="https://blog.csdn.net/qq_41800366/article/details/86583789">梯度下降算法原理讲解- - 机器学习</a>.</p>
<p>本文顺着这篇文章的内容逐级递进, 来看看梯度下降的一些基础信息.</p>
<h3 id="12-简单数学推导">1.2 简单数学推导</h3>
<p>以文章中的代码中的数据为例, 其目标是使用梯度下降方法对<code>Y</code>数据集进行一元线性回归拟合.</p>
<pre><code class="language-python">Y = array([
    3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    11, 13, 13, 16, 17, 18, 17, 19, 21
]).reshape(m, 1)
</code></pre>
<figure data-type="image" tabindex="2"><a href="https://imgse.com/i/pp5SkdJ"><img src="https://s1.ax1x.com/2023/04/04/pp5SkdJ.png" alt="pp5SkdJ.png" loading="lazy"></a></figure>
<p>(<em>图: 使用excel进行拟合</em>)</p>
<p>数学推导是不可避免, 如果不了解其中的数学原理, 否则难以理解后续的代码的实现.</p>
<p>即</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>w</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace linebreak="newline"></mspace><mi>w</mi><mo separator="true">,</mo><mi mathvariant="normal">斜</mi><mi mathvariant="normal">率</mi><mo separator="true">,</mo><mi mathvariant="normal">也</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">元</mi><mi mathvariant="normal">线</mi><mi mathvariant="normal">性</mi><mi mathvariant="normal">回</mi><mi mathvariant="normal">归</mi><mi mathvariant="normal">中</mi><mi mathvariant="normal">最</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">关</mi><mi mathvariant="normal">注</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">参</mi><mi mathvariant="normal">数</mi><mo separator="true">,</mo><mspace linebreak="newline"></mspace><mi>b</mi><mo separator="true">,</mo><mi mathvariant="normal">常</mi><mi mathvariant="normal">量</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">获</mi><mi mathvariant="normal">得</mi><mi mathvariant="normal">这</mi><mi mathvariant="normal">两</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">参</mi><mi mathvariant="normal">数</mi><mo separator="true">,</mo><mi mathvariant="normal">即</mi><mi mathvariant="normal">可</mi><mi mathvariant="normal">确</mi><mi mathvariant="normal">定</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">元</mi><mi mathvariant="normal">线</mi><mi mathvariant="normal">性</mi><mi mathvariant="normal">回</mi><mi mathvariant="normal">归</mi><mi mathvariant="normal">方</mi><mi mathvariant="normal">程</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">y = wx + b\\
w, 斜率, 也是一元线性回归中最为关注的参数,\\
b, 常量\\
获得这两个参数, 即可确定一个一元线性回归方程.
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">斜</span><span class="mord cjk_fallback">率</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">也</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">元</span><span class="mord cjk_fallback">线</span><span class="mord cjk_fallback">性</span><span class="mord cjk_fallback">回</span><span class="mord cjk_fallback">归</span><span class="mord cjk_fallback">中</span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">关</span><span class="mord cjk_fallback">注</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">参</span><span class="mord cjk_fallback">数</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">b</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">常</span><span class="mord cjk_fallback">量</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.3em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">获</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">两</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">参</span><span class="mord cjk_fallback">数</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">确</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">元</span><span class="mord cjk_fallback">线</span><span class="mord cjk_fallback">性</span><span class="mord cjk_fallback">回</span><span class="mord cjk_fallback">归</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">程</span><span class="mord">.</span></span></span></span></span></p>
<figure data-type="image" tabindex="3"><a href="https://imgse.com/i/pp4oz2d"><img src="https://s1.ax1x.com/2023/04/04/pp4oz2d.png" alt="pp4oz2d.png" loading="lazy"></a></figure>
<p>回到视频的内容, 看看使用梯度下降法是怎么实现这个拟合过程的.</p>
<ol>
<li>设定起始点(或者说预设的w, b)</li>
<li>(假设)绘制一条线(得到一组新的Y预测值坐标)</li>
<li>计算各个预测y_predit和实际y_actual的点差值, 和设定的阈值比较(或者设置迭代的次数), 跳出循环, 返回<code>w, b</code>的值, 结束程序</li>
<li><strong>调整参数w, b</strong>(即, 梯度变化)</li>
<li>循环执行 2 - 3 - 4 - 5</li>
</ol>
<p>这个衡量偏差的方式, 最为常见的是最小二乘法(还是叫最小平方法吧), <a href="https://en.wikipedia.org/wiki/Least_squares">Wikipedia, Least_squares</a>.</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">基</mi><mi mathvariant="normal">于</mi><mi mathvariant="normal">上</mi><mi mathvariant="normal">述</mi><mi mathvariant="normal">逻</mi><mi mathvariant="normal">辑</mi><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mi>w</mi><mi>x</mi><mo>+</mo><mi>b</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">将</mi><mi mathvariant="normal">拟</mi><mi mathvariant="normal">合</mi><mi mathvariant="normal">问</mi><mi mathvariant="normal">题</mi><mi mathvariant="normal">转</mi><mi mathvariant="normal">为</mi><mo separator="true">,</mo><msub><mi>y</mi><mi>i</mi></msub><mo>=</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>+</mo><msub><mi>e</mi><mi>i</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">其</mi><mi mathvariant="normal">中</mi><msub><mi>e</mi><mi>i</mi></msub><mi mathvariant="normal">就</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">拟</mi><mi mathvariant="normal">合</mi><mi mathvariant="normal">函</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">误</mi><mi mathvariant="normal">差</mi><mi mathvariant="normal">值</mi><mi mathvariant="normal">.</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">而</mi><mi mathvariant="normal">我</mi><mi mathvariant="normal">们</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">就</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">使</mi><mi mathvariant="normal">得</mi><mi mathvariant="normal">这</mi><mi mathvariant="normal">个</mi><msub><mi>e</mi><mi>i</mi></msub><mi mathvariant="normal">最</mi><mi mathvariant="normal">小</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">消</mi><mi mathvariant="normal">除</mi><mi mathvariant="normal">符</mi><mi mathvariant="normal">号</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">影</mi><mi mathvariant="normal">响</mi><mo separator="true">,</mo><mi mathvariant="normal">即</mi><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><msubsup><mi>e</mi><mi>i</mi><mn>2</mn></msubsup><mo>)</mo><mo>(</mo><mi mathvariant="normal">另</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">方</mi><mi mathvariant="normal">面</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">平</mi><mi mathvariant="normal">方</mi><mi mathvariant="normal">可</mi><mi mathvariant="normal">以</mi><mi mathvariant="normal">起</mi><mi mathvariant="normal">到</mi><mi mathvariant="normal">对</mi><mi mathvariant="normal">数</mi><mi mathvariant="normal">据</mi><mi mathvariant="normal">缩</mi><mi mathvariant="normal">放</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">效</mi><mi mathvariant="normal">果</mi><mo separator="true">,</mo><mi mathvariant="normal">偏</mi><mi mathvariant="normal">差</mi><mi mathvariant="normal">小</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">越</mi><mi mathvariant="normal">小</mi><mo separator="true">,</mo><mi mathvariant="normal">偏</mi><mi mathvariant="normal">差</mi><mi mathvariant="normal">大</mi><mi mathvariant="normal">的</mi><mi mathvariant="normal">越</mi><mi mathvariant="normal">大</mi><mo>)</mo><mspace linebreak="newline"></mspace><mi mathvariant="normal">存</mi><mi mathvariant="normal">在</mi><mi mathvariant="normal">多</mi><mi mathvariant="normal">个</mi><mi>y</mi><mo separator="true">,</mo><mtext>  </mtext><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>y</mi><mn>2</mn></msub><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><msub><mi>y</mi><mi>n</mi></msub><mspace linebreak="newline"></mspace><mi mathvariant="normal">即</mi><mi mathvariant="normal">目</mi><mi mathvariant="normal">标</mi><mi mathvariant="normal">转</mi><mi mathvariant="normal">换</mi><mi mathvariant="normal">为</mi><msub><mi>e</mi><mi>i</mi></msub><mo>=</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>b</mi><mspace linebreak="newline"></mspace><mi mathvariant="normal">即</mi><mo>:</mo><mspace linebreak="newline"></mspace><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msubsup><mi>e</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>b</mi><msup><mo>)</mo><mn>2</mn></msup><mspace linebreak="newline"></mspace><mi>f</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><mi>b</mi><msup><mo>)</mo><mn>2</mn></msup><mspace linebreak="newline"></mspace><mi mathvariant="normal">分</mi><mi mathvariant="normal">别</mi><mi mathvariant="normal">对</mi><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mi mathvariant="normal">求</mi><mi mathvariant="normal">偏</mi><mi mathvariant="normal">导</mi><mo separator="true">,</mo><mi mathvariant="normal">这</mi><mi mathvariant="normal">是</mi><mi mathvariant="normal">一</mi><mi mathvariant="normal">个</mi><mi mathvariant="normal">下</mi><mi mathvariant="normal">凸</mi><mi mathvariant="normal">函</mi><mi mathvariant="normal">数</mi><mo separator="true">,</mo><mi mathvariant="normal">即</mi><mo separator="true">,</mo><mi mathvariant="normal">极</mi><mi mathvariant="normal">值</mi><mi mathvariant="normal">为</mi><mi mathvariant="normal">极</mi><mi mathvariant="normal">小</mi><mi mathvariant="normal">值</mi><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><msub><mi>x</mi><mi>i</mi></msub><mo>(</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mn>2</mn><mo>(</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">基于上述逻辑, y = wx + b\\
将拟合问题转为, y_i = wx_i + b + e_i, 其中e_i就是拟合函数的误差值.\\
而我们的目标就是使得这个e_i最小\\
消除符号的影响, 即 min (e_i^2)(另一方面数据的平方可以起到对数据缩放的效果, 偏差小的越小, 偏差大的越大)\\
存在多个y,\; y_1, y_2...y_n\\
即目标转换为e_i = y_i - wx_i - b\\
即:\\
\sum_{i=1}^n e_i^2 = \sum_{i= 1}^n(y_i - wx_i - b) ^ 2 \\
f(w, b) = \sum_{i= 1}^n(y_i - wx_i - b) ^ 2\\
分别对w, b求偏导, 这是一个下凸函数, 即, 极值为极小值\\
\frac{\partial{f(w, b)}}{\partial{w}} = \sum_{i=1}^n2x_i(wx_i + b - y_i)\\
\frac{\partial{f(w, b)}}{\partial{b}} = \sum_{i=1}^n2(wx_i + b - y_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">基</span><span class="mord cjk_fallback">于</span><span class="mord cjk_fallback">上</span><span class="mord cjk_fallback">述</span><span class="mord cjk_fallback">逻</span><span class="mord cjk_fallback">辑</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">拟</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">问</span><span class="mord cjk_fallback">题</span><span class="mord cjk_fallback">转</span><span class="mord cjk_fallback">为</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">中</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">拟</span><span class="mord cjk_fallback">合</span><span class="mord cjk_fallback">函</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">误</span><span class="mord cjk_fallback">差</span><span class="mord cjk_fallback">值</span><span class="mord">.</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">而</span><span class="mord cjk_fallback">我</span><span class="mord cjk_fallback">们</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">使</span><span class="mord cjk_fallback">得</span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">个</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord cjk_fallback">最</span><span class="mord cjk_fallback">小</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord cjk_fallback">消</span><span class="mord cjk_fallback">除</span><span class="mord cjk_fallback">符</span><span class="mord cjk_fallback">号</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">影</span><span class="mord cjk_fallback">响</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">即</span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mopen">(</span><span class="mord cjk_fallback">另</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">平</span><span class="mord cjk_fallback">方</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">起</span><span class="mord cjk_fallback">到</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">据</span><span class="mord cjk_fallback">缩</span><span class="mord cjk_fallback">放</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">效</span><span class="mord cjk_fallback">果</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">差</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">越</span><span class="mord cjk_fallback">小</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">差</span><span class="mord cjk_fallback">大</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">越</span><span class="mord cjk_fallback">大</span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">存</span><span class="mord cjk_fallback">在</span><span class="mord cjk_fallback">多</span><span class="mord cjk_fallback">个</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">目</span><span class="mord cjk_fallback">标</span><span class="mord cjk_fallback">转</span><span class="mord cjk_fallback">换</span><span class="mord cjk_fallback">为</span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7777700000000001em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord cjk_fallback">即</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">e</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord cjk_fallback">分</span><span class="mord cjk_fallback">别</span><span class="mord cjk_fallback">对</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mord cjk_fallback">求</span><span class="mord cjk_fallback">偏</span><span class="mord cjk_fallback">导</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">这</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">下</span><span class="mord cjk_fallback">凸</span><span class="mord cjk_fallback">函</span><span class="mord cjk_fallback">数</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">即</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord cjk_fallback">极</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">为</span><span class="mord cjk_fallback">极</span><span class="mord cjk_fallback">小</span><span class="mord cjk_fallback">值</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<h2 id="二-文章代码">二. 文章代码</h2>
<p>这里直接引用<a href="https://blog.csdn.net/qq_41800366/article/details/86583789">原文章</a>中的代码, 由于其计算全部使用矩阵(<code>numpy</code>)来计算, 在理解上, 对于不熟悉<code>numpy/matrix</code>的新手而言不是很友好.</p>
<figure data-type="image" tabindex="4"><a href="https://imgse.com/i/pp4HrgH"><img src="https://s1.ax1x.com/2023/04/04/pp4HrgH.png" alt="pp4HrgH.png" loading="lazy"></a></figure>
<pre><code class="language-python"># 评论中提及的部分代码

X = hstack((X0, X1))  # 按照列堆叠形成数组 其实就是样本数据
</code></pre>
<p>不清楚原作者的代码是否是原生, 但是作者没有解释这部分内容, 而且从注释内容来看, 作者对于<code>numpy</code>的矩阵使用还不是很好.</p>
<p>(注意: <em>下面的注释内容也是原代码自带的</em>)</p>
<pre><code class="language-python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# @Time    : 2019/1/21 21:06
# @Author  : Arrow and Bullet
# @FileName: gradient_descent.py
# @Software: PyCharm
# @Blog    : https://blog.csdn.net/qq_41800366

from numpy import *
import matplotlib.pyplot as plt

# 数据集大小 即20个数据点
m = 20
# x的坐标以及对应的矩阵
X0 = ones((m, 1))  # 生成一个m行1列的向量 也就是x0 全是1
X1 = arange(1, m+1).reshape(m, 1)  # 生成一个m行1列的向量 也就是x1 从1到m
X = hstack((X0, X1))  # 按照列堆叠形成数组 其实就是样本数据
# 对应的y坐标
Y = array([
    3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    11, 13, 13, 16, 17, 18, 17, 19, 21
]).reshape(m, 1)
# 学习率
alpha = 0.01

# 定义代价函数
def cost_function(theta, X, Y):
    # dot() 数组需要像矩阵那样相乘 就需要用到dot()
    diff = dot(X, theta) - Y
    return (1/((m * 2))) * dot(diff.transpose(), diff)

# 定义代价函数对应的梯度函数
def gradient_function(theta, X, Y):
    diff = dot(X, theta) - Y
    return (1/m) * dot(X.transpose(), diff)

# 梯度下降迭代
def gradient_descent(X, Y, alpha):
    theta = array([1, 1]).reshape(2, 1)
    gradient = gradient_function(theta, X, Y)
    while not all(abs(gradient) &lt;= 1e-5):
        theta = theta - alpha * gradient
        gradient = gradient_function(theta, X, Y)
    return theta

optimal = gradient_descent(X, Y, alpha)
print('optimal:', optimal)
print('cost function:', cost_function(optimal, X, Y)[0][0])

# 根据数据画出对应的图像
def plot(X, Y, theta):

    ax = plt.subplot(111)  # 这是我改的
    ax.scatter(X, Y, s=30, c=&quot;red&quot;, marker=&quot;s&quot;)
    plt.xlabel(&quot;X&quot;)
    plt.ylabel(&quot;Y&quot;)
    x = arange(0, 21, 0.2)  # x的范围
    y = theta[0] + theta[1]*x
    ax.plot(x, y)
    plt.show()

plot(X1, Y, optimal)

</code></pre>
<h3 id="21-代码解析">2.1 代码解析</h3>
<p>在梯度下降中的两个关键点:</p>
<ul>
<li>学习率</li>
<li>损失函数</li>
</ul>
<blockquote>
<ul>
<li><strong>Learning rate</strong> (also referred to as step size or the alpha) is the size of the steps that are taken to reach the minimum. This is typically a small value, and it is evaluated and updated based on the behavior of the cost function. High learning rates result in larger steps but risks overshooting the minimum. Conversely, a low learning rate has small step sizes. While it has the advantage of more precision, the number of iterations compromises overall efficiency as this takes more time and computations to reach the minimum.</li>
<li><strong>The cost (or loss) function</strong> measures the difference, or error, between actual y and predicted y at its current position. This improves the machine learning model's efficacy by providing feedback to the model so that it can adjust the parameters to minimize the error and find the local or global minimum. It continuously iterates, moving along the direction of steepest descent (or the negative gradient) until the cost function is close to or at zero. At this point, the model will stop learning. Additionally, while the terms, cost function and loss function, are considered synonymous, there is a slight difference between them. It’s worth noting that a loss function refers to the error of one training example, while a cost function calculates the average error across an entire training set.</li>
</ul>
<p>from IBM</p>
</blockquote>
<figure data-type="image" tabindex="5"><a href="https://imgse.com/i/pp4o4C4"><img src="https://s1.ax1x.com/2023/04/04/pp4o4C4.png" alt="pp4o4C4.png" loading="lazy"></a></figure>
<p>(<em>图: 引用视频的内容</em>)</p>
<p>首先是数据的构造部分.</p>
<pre><code class="language-python">X
# 作者并未标注, 这部分, 这个1从何而来, 为什么要加入 1
# 见下图
array([[ 1.,  1.],
       [ 1.,  2.],
       [ 1.,  3.],
       [ 1.,  4.],
       [ 1.,  5.],
       [ 1.,  6.],
       [ 1.,  7.],
       [ 1.,  8.],
       [ 1.,  9.],
       [ 1., 10.],
       [ 1., 11.],
       [ 1., 12.],
       [ 1., 13.],
       [ 1., 14.],
       [ 1., 15.],
       [ 1., 16.],
       [ 1., 17.],
       [ 1., 18.],
       [ 1., 19.],
       [ 1., 20.]])

# w, b初始设置为1, 1
theta = np.array([1, 1]).reshape(2, 1)

array([[1],
       [1]])

theta

# 这一步就是得到一条新的线的(y)坐标
# 这样联系前后内容, 这就是 y = 1 * x + 1的矩阵版本
np.dot(X, theta)
array([[ 2.],
       [ 3.],
       [ 4.],
       [ 5.],
       [ 6.],
       [ 7.],
       [ 8.],
       [ 9.],
       [10.],
       [11.],
       [12.],
       [13.],
       [14.],
       [15.],
       [16.],
       [17.],
       [18.],
       [19.],
       [20.],
       [21.]])

Y # 真实值
array([[ 3],
       [ 4],
       [ 5],
       [ 5],
       [ 2],
       [ 4],
       [ 7],
       [ 8],
       [11],
       [ 8],
       [12],
       [11],
       [13],
       [13],
       [16],
       [17],
       [18],
       [17],
       [19],
       [21]])
</code></pre>
<figure data-type="image" tabindex="6"><a href="https://imgse.com/i/ppIvsWq"><img src="https://s1.ax1x.com/2023/04/06/ppIvsWq.png" alt="ppIvsWq.png" loading="lazy"></a></figure>
<p>相关的矩阵推导方式见, <a href="https://iewaij.github.io/introDataScience/OLS.html">OLS (iewaij.github.io, 最小二乘法线性回归: 矩阵视角)</a>.</p>
<blockquote>
<p>修改与勘误</p>
<ul>
<li>修改了最后一段结论.</li>
<li>XTX 的逆矩阵存在需要两个条件 1. 线性无关 2. 行数 &gt; 列数 因此修改了文章对 (XTX) ^ −1 存在的条件和直觉上的理解.</li>
</ul>
<p><em>作者最后一段还有勘误, 显然作者对自己写的东西很重视.</em></p>
</blockquote>
<figure data-type="image" tabindex="7"><a href="https://imgse.com/i/pp4b6WF"><img src="https://s1.ax1x.com/2023/04/04/pp4b6WF.png" alt="pp4b6WF.png" loading="lazy"></a></figure>
<p>(<em>上述代码第一次迭代后的坐标绘制的线</em>)</p>
<p>知道大概的执行逻辑, 但是对于其中细节的理解不容易, 更不容易的是要将数学符号转为代码(这一步, 从一些大神写的算法来看, 犯错也是常见的现象, 尽管代码最终的执行在很多情况下<strong>看似满足要求</strong>, 但是存在一些稍微极端的条件下崩溃, 或者是数据集大一点, 运行速度无比缓慢等问题), 这是在算法和模型中常见的情况.(即, 数学推导和逻辑都貌似讲通了, 但是写出来的代码还是运行不了.)</p>
<pre><code class="language-python">def gradient_function(theta, X, Y):
    # 得到的预测值和实际的Y点的偏差
    diff = dot(X, theta) - Y
    # 但是这一步?
    # 这步的目的在于返回 w, b 两个值的梯度变化值, 但是这一步怎么实现, 要斟酌一番
    return (1/m) * dot(X.transpose(), diff)
</code></pre>
<pre><code class="language-bash"># 即这一步的目的, 实际上就是计算Y轴上各个点的差值
diff = np.dot(X, theta) - Y

# dot, 矩阵相乘, transpose转置

(1/m) * dot(X.transpose(), diff)

# 这一步得到的是w, b的梯度, 即数学式中的对w, b的偏导
dot(X.transpose(), diff)

array([[ 16.],
       [188.]])
</code></pre>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>x</mi><mi>i</mi></msub><mo>(</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mrow><mi>f</mi><mo>(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo>)</mo></mrow></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>(</mo><mi>w</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">\frac{\partial{f(w, b)}}{\partial{w}} = \sum_{i=1}^nx_i(wx_i + b - y_i)\\
\frac{\partial{f(w, b)}}{\partial{b}} = \sum_{i=1}^n(wx_i + b - y_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault">b</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<pre><code class="language-python"># 将上述代码改成纯矩阵的形式来运算方便一点

mw = np.mat([[1.0, i] for i in range(1, 21)], float)
my = np.mat([[e] for e in y], float)
theta = np.mat([[1], [1]])

diff = mw * theta - my

# 这里这一步就等价于 wx _ b - y, 由于2的存在在学习率中会被剔除掉, 所以这里不需要2
# 这一步的操作就相当于上述的数学的推导式的运算

(1/m) * mw.transpose() * diff
</code></pre>
<pre><code class="language-python"># 这样将代码拆解开, 就可以看到矩阵之下的运算

mw.transpose()

matrix([[ 1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,  1.,
          1.,  1.,  1.,  1.,  1.,  1.,  1.],
        [ 1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11., 12., 13.,
         14., 15., 16., 17., 18., 19., 20.]])
</code></pre>
<p>上述即为文章代码的解析.</p>
<p>再对照下面的普通代码的实现,  相关的代码理解就变得很容易了.</p>
<p><em>(不管是矩阵方式还是普通方式, 上述的计算产生的临时变量的值很容易会超出python的计算范围,</em> 导致<code>overflow</code>错误)*</p>
<p><strong>关于<code>np.array</code>和<code>np.mat</code>之间的差异</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align:center">Numpy np.array()</th>
<th style="text-align:center">Numpy np.matrix()</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Syntax:  numpy.array(object, dtype=None)</td>
<td style="text-align:center">Syntax: numpy.matrix(object, dtype=None)</td>
</tr>
<tr>
<td style="text-align:center">Numpy arrays (nd-arrays) are N-dimensional where, N=1,2,3…</td>
<td style="text-align:center">Numpy matrices are <strong>strictly 2-dimensional.</strong></td>
</tr>
<tr>
<td style="text-align:center">nd-arrays are base classes for matrix objects</td>
<td style="text-align:center">Matrix objects are a subclass of nd-array.</td>
</tr>
<tr>
<td style="text-align:center">Matrix objects have arr.I for the inverse.</td>
<td style="text-align:center">Array objects don’t.</td>
</tr>
<tr>
<td style="text-align:center">If a and b are matrices, then a@b or np.dot(a,b) is their matrix product</td>
<td style="text-align:center">If a and b are matrices, then a*b is their matrix product.</td>
</tr>
</tbody>
</table>
<p>简而言之, <code>matrix</code>是<code>array</code>的子类, <code>matrix</code>仅支持二维的数据结构, 而<code>array</code>支持不限, 但是在运算上, matrix更为方便.</p>
<h3 id="22-梯度是什么">2.2 梯度是什么?</h3>
<figure data-type="image" tabindex="8"><img src="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/images/gradient_descent/figure2.png" alt="img" loading="lazy"></figure>
<p>这里只做简单的介绍, 实际上就是导数, 为了更直观的理解, 先看看两个简单的例子.</p>
<pre><code class="language-python"># 假设存在 y = 5x ^ 2 + 8x + 1
# 计算最小值出现的位置

def get_grade(w):
    return 10 * w + 8

def gradient_descent():
    learning_r = 1e-3
    threshold = 1e-8
    w = 0
    ic = 0
    while True:
        g = get_grade(w)
        w -= learning_r * g
        ic += 1
        if g &lt; threshold:
            print(f'break: {ic}')
            break

    return w

gradient_descent()

break: 2041
-0.7999999990125343 # =&gt; - 0.8
</code></pre>
<pre><code class="language-python"># f(x, y) = x ^ 2 + y ^ 2 + 2x
# 计算x, y, f最小
def get_grade_s(w, b):
    return 2 * w + 2, 2 * b

def gradient_descent_s():
    learning_r = 1e-3
    threshold = 1e-8
    w = 0
    b = 0
    ic = 0
    while True:
        g_w, g_b = get_grade_s(w, b)
        w -= learning_r * g_w
        b = learning_r * g_b
        ic += 1
        if g_w &lt; threshold and g_b &lt; threshold:
            print(f'break: {ic}')
            break

    return w, b
gradient_descent_s()

break: 9549
(-0.9999999950164505, 0.0) # =&gt; -1, 0
</code></pre>
<h2 id="三-简单代码实现">三. 简单代码实现</h2>
<p>由于上面文章中的代码使用矩阵方式并不好理解, 以下代码以最简单的方式实现, 在计算中没有使用任何的第三方库.</p>
<pre><code class="language-python">import time
import random
import matplotlib.pyplot as plt

#  绘图部分
def draw_chart(data):
    fig, axs = plt.subplots(2, 2)
    ic = 0
    for i in range(2):
        for j in range(2):
            r = data[ic]
            x = range(len(r[1]))
            ax = axs[i][j]
            ax.plot(x, r[1])
            ax.set_title(r[0])
            ic += 1
    plt.show()

# 装饰器, 用于计算时间, 返回执行的发起函数名称等
def decorator(func):
    def wrapper(*args, **kwargs):
        f_name = func.__name__
        s = time.time()
        w, b, c, lse_list = func(*args, **kwargs)
        print(f'{f_name}, cost time: {round(time.time() - s, 4)}; {f_name}: y = {w} * x + {b}; iter_times: {c};')
        return f_name, lse_list

    return wrapper

class Gradient:
    @property
    def learning_ratio(self) -&gt; float:
        return self.__learning_ratio

    @learning_ratio.setter
    def learning_ratio(self, ratio: float):
        self.__learning_ratio = ratio

    @property
    def threshold(self) -&gt; float:
        return self.__learning_ratio

    @threshold.setter
    def threshold(self, threshold: float):
        self.__threshold = threshold

    def __init__(self):
        self.__learning_ratio = 0.01
        self.__threshold = 1e-8
        self.__lse_list = None

    @staticmethod
    def __get_y_deviation(wx, b, y):
        return wx + b - y

    def __get_grade(self, grad_w, grad_b, m: int) -&gt; tuple:
        # 数学推导式中的 2, 2x_i(wx_i + b - y_i)
        # 这是一个常量, 在这里, 实际上就相当于 self.__learning_ratio = self.__learning_ratio * 2 ( 2的存在不重要 )
        return self.__learning_ratio * grad_w / m, self.__learning_ratio * grad_b / m

    @staticmethod
    def __get_least_squares(x, y, w, b, m):
        return sum((w * x[_] + b - y[_]) ** 2 for _ in range(m))

    @decorator
    def descent(self, x, y, w=0, b=0, iter_times=0):
        # 传统的计算方式, 即所谓的(全)批量梯度下降
        # 即每次更新参数, 使用全部数据来计算
        # 效果最好, 但是假如数据量很大, 这种方式的时间代价很大
        m = len(x)
        if len(y) != m or m == 0:
            return
        iter_times = iter_times | 10000
        lse = 0
        count = 0
        lse_list = []
        for _ in range(iter_times):
            count += 1
            grad_w, grad_b = 0, 0
            for i in range(m):
                # 关于 数学推导式中的2为什么不出现在这里, 见上
                d = self.__get_y_deviation(w * x[i], b, y[i])
                grad_w += x[i] * d
                grad_b += d

            grades = self.__get_grade(grad_w, grad_b, m)
            w -= grades[0]
            b -= grades[1]

            lse_new = self.__get_least_squares(x, y, w, b, m)
            err = abs(lse_new - lse)
            lse_list.append(err)
            if err &lt; self.__threshold:
                break
            lse = lse_new

        return w, b, count, lse_list

    @decorator
    def random_batch_descent(self, x, y, w=0, b=0, iter_times=0):
        # 这是个人加入的测试方法

        m = len(x)
        if len(y) != m or m == 0:
            return
        iter_times = iter_times | 10000
        lse = 0
        count = 0
        lse_list = []
        for _ in range(iter_times):
            count += 1
            grad_w, grad_b = 0, 0
            mc = 0
            i = 0
            while i &lt; m:
                d = self.__get_y_deviation(w * x[i], b, y[i])
                mc += 1
                grad_w += x[i] * d
                grad_b += d
                i += random.choice(range(m))

            grades = self.__get_grade(grad_w, grad_b, mc)
            w -= grades[0]
            b -= grades[1]

            lse_new = self.__get_least_squares(x, y, w, b, m)
            err = abs(lse_new - lse)
            lse_list.append(err)
            if err &lt; self.__threshold:
                break
            lse = lse_new

        return w, b, count, lse_list

    @decorator
    def fix_batch_descent(self, x, y, fix=5, w=0, b=0, iter_times=0):
        # 小批量梯度下降
        # 即使用部分的数据来更新参数
        # 计算量较小
        # 同时较大可能避免随机梯度下降不可收敛的情况

        m = len(x)
        if len(y) != m or m == 0:
            return
        iter_times = iter_times | 10000
        lse = 0
        count = 0
        lse_list = []
        for _ in range(iter_times):
            count += 1
            grad_w, grad_b = 0, 0
            mc = 0
            i = 0
            while i &lt; m:
                d = self.__get_y_deviation(w * x[i], b, y[i])
                mc += 1
                grad_w += x[i] * d
                grad_b += d
                i += fix

            grades = self.__get_grade(grad_w, grad_b, mc)
            w -= grades[0]
            b -= grades[1]

            lse_new = self.__get_least_squares(x, y, w, b, m)
            err = abs(lse_new - lse)
            lse_list.append(err)
            if err &lt; self.__threshold:
                break
            lse = lse_new

        return w, b, count, lse_list

    @decorator
    def random_descent(self, x, y, w=0, b=0, iter_times=0):
        # 随机梯度下降
        # 对于数据质量很好的情况下, 拟合速度极快

        m = len(x)
        if len(y) != m or m == 0:
            return
        iter_times = iter_times | 10000
        lse = 0
        count = 0
        index_s = list(range(m))
        lse_list = []
        for _ in range(iter_times):
            # 洗牌算法, 打乱顺序
            random.shuffle(index_s)
            for i in index_s:
                d = self.__get_y_deviation(w * x[i], b, y[i])
                grad_w = x[i] * d
                grad_b = d
                w -= grad_w * self.__learning_ratio
                b -= grad_b * self.__learning_ratio
                # 梯度的计算, 每次只是用一个点
                # 但是对于偏差这一步是不是样算?
                # 假如计算全部的点, 会不会计算量反而变大了
                # 但是使用一个点, 是不是出现较大的偏差
                # ?
                lse_new = (w * x[i] + b - y[i]) ** 2
                err = abs(lse_new - lse)
                lse_list.append(err)
                count += 1
                if err &lt; self.__threshold:
                    break
                lse = lse_new
            else:
                continue
            break

        return w, b, count, lse_list

if __name__ == '__main__':
    mx = 21

    # 可以尝试调整 mx, 数据量
    # 将数据调整超过25个, 有彩蛋, 包括上面csdn那篇文章中的示例代码
    # 很容易就出现overflow, too big data
    # 计算产生的临时变量超过python可处理的数据范围

    g = Gradient()
    cx = list(range(1, mx))
    # 调整数据的质量
    cy = [10 * e + 35 for e in cx]
    # cy = [
    #     3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    #     11, 13, 13, 16, 17, 18, 17, 19, 21
    # ]
    rs = [
        g.descent(cx, cy),
        g.random_descent(cx, cy),
        g.fix_batch_descent(cx, cy, fix=2),
        g.random_batch_descent(cx, cy),
    ]
    draw_chart(rs)

</code></pre>
<figure data-type="image" tabindex="9"><a href="https://imgse.com/i/ppIOfwd"><img src="https://s1.ax1x.com/2023/04/06/ppIOfwd.png" alt="ppIOfwd.png" loading="lazy"></a></figure>
<p>(<em>图: 当数据相对混乱时</em>)</p>
<pre><code class="language-bash"># 使用这组数据集
# cy = [
#     3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
#     11, 13, 13, 16, 17, 18, 17, 19, 21
# ]

C:\Users\Lian\anaconda3\envs\test_env\python.exe C:\Users\Lian\AppData\Roaming\JetBrains\PyCharmCE2022.3\scratches\d.py
descent, cost time: 0.041; descent: y = 0.9699748091998006 * x + 0.5151072764520226; iter_times: 2806;
random_descent, cost time: 0.291; random_descent: y = 0.9750956384509113 * x + 0.35956085499107115; iter_times: 200000;
fix_batch_descent, cost time: 0.06; fix_batch_descent: y = 0.9818183284143631 * x + 0.7818162357058347; iter_times: 5181;
random_batch_descent, cost time: 0.108; random_batch_descent: y = 0.9293798370394002 * x + 1.7094459809462543; iter_times: 10000;
</code></pre>
<figure data-type="image" tabindex="10"><a href="https://imgse.com/i/ppIOxkn"><img src="https://s1.ax1x.com/2023/04/06/ppIOxkn.png" alt="ppIOxkn.png" loading="lazy"></a></figure>
<p>(<em>图: 当数相对&quot;整齐&quot;时</em>)</p>
<pre><code class="language-bash"># 使用这组数据集, cy = [10 * e + 35 for e in cx]

C:\Users\Lian\anaconda3\envs\test_env\python.exe C:\Users\Lian\AppData\Roaming\JetBrains\PyCharmCE2022.3\scratches\d.py
descent, cost time: 0.077; descent: y = 10.00004998440988 * x + 34.999317976872284; iter_times: 4689;
random_descent, cost time: 0.006; random_descent: y = 10.000875349135297 * x + 34.99359742408765; iter_times: 3803;
fix_batch_descent, cost time: 0.052; fix_batch_descent: y = 10.000049557563383 * x + 34.999342107105704; iter_times: 4394;
random_batch_descent, cost time: 0.026; random_batch_descent: y = 10.000067579707812 * x + 34.998977119937905; iter_times: 2371;
</code></pre>
<ul>
<li>descent, 传统的模式</li>
<li>random_descent, 随机模式</li>
<li>fix_batch_descent, 小批量模式(固定批量的值)</li>
<li>random_batch_descent, 每次的批量值动态变化</li>
</ul>
<p>不同的数据集的测试效果, 注意不同数据集之下的<strong>时间消耗</strong>和<strong>拟合效果</strong>.</p>
<p>通常而言, 不管是算法还是模型, 都有两个关键指标衡量其执行, 但二者往往是不可兼得.</p>
<ul>
<li>效果</li>
<li>效率(执行的速度)</li>
</ul>
<h2 id="四-其他拟合方式">四. 其他拟合方式</h2>
<p>当然, 上述的内容主要是为了了解梯度下降, 最小二乘(最小平方)等基本的原理, 实际的使用, 需要拟合一元回归或者其他更复杂的模型, 很多现成的方案.</p>
<pre><code class="language-python"># 快捷的方式 =&gt; excel
from scipy import stats

x = list(range(1, 21))
y = [
    3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    11, 13, 13, 16, 17, 18, 17, 19, 21
]

stats.linregress(x, y)
'''
LinregressResult(
    slope=0.9699248120300752,
    intercept=0.5157894736842099,
    rvalue=0.9690508744938254,
    pvalue=2.211450394914175e-12,
    stderr=0.058238193980801746,
    intercept_stderr=0.6976439770211438
)
'''
</code></pre>
<pre><code class="language-python"># 严谨的方式 =&gt; spss

import statsmodels.api as sta

x = sta.add_constant(x)
model = sta.OLS(y, x).fit()
model.summary()
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:right">OLS Regression Results</th>
<th style="text-align:right"></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Dep. Variable:</td>
<td style="text-align:right">y</td>
<td>R-squared:</td>
<td>0.939</td>
</tr>
<tr>
<td style="text-align:right">Model:</td>
<td style="text-align:right">OLS</td>
<td>Adj. R-squared:</td>
<td>0.936</td>
</tr>
<tr>
<td style="text-align:right">Method:</td>
<td style="text-align:right">Least Squares</td>
<td>F-statistic:</td>
<td>277.4</td>
</tr>
<tr>
<td style="text-align:right">Date:</td>
<td style="text-align:right">Thu, 06 Apr 2023</td>
<td>Prob (F-statistic):</td>
<td>2.21e-12</td>
</tr>
<tr>
<td style="text-align:right">Time:</td>
<td style="text-align:right">18:36:59</td>
<td>Log-Likelihood:</td>
<td>-35.459</td>
</tr>
<tr>
<td style="text-align:right">No. Observations:</td>
<td style="text-align:right">20</td>
<td>AIC:</td>
<td>74.92</td>
</tr>
<tr>
<td style="text-align:right">Df Residuals:</td>
<td style="text-align:right">18</td>
<td>BIC:</td>
<td>76.91</td>
</tr>
<tr>
<td style="text-align:right">Df Model:</td>
<td style="text-align:right">1</td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:right">Covariance Type:</td>
<td style="text-align:right">nonrobust</td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:right"></th>
<th style="text-align:right">coef</th>
<th style="text-align:right">std err</th>
<th style="text-align:right">t</th>
<th style="text-align:right">P&gt;|t|</th>
<th style="text-align:right">[0.025</th>
<th>0.975]</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">const</td>
<td style="text-align:right">0.5158</td>
<td style="text-align:right">0.698</td>
<td style="text-align:right">0.739</td>
<td style="text-align:right">0.469</td>
<td style="text-align:right">-0.950</td>
<td>1.981</td>
</tr>
<tr>
<td style="text-align:right">x1</td>
<td style="text-align:right">0.9699</td>
<td style="text-align:right">0.058</td>
<td style="text-align:right">16.654</td>
<td style="text-align:right">0.000</td>
<td style="text-align:right">0.848</td>
<td>1.092</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th style="text-align:right">Omnibus:</th>
<th style="text-align:right">2.687</th>
<th>Durbin-Watson:</th>
<th>1.649</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right">Prob(Omnibus):</td>
<td style="text-align:right">0.261</td>
<td>Jarque-Bera (JB):</td>
<td>2.068</td>
</tr>
<tr>
<td style="text-align:right">Skew:</td>
<td style="text-align:right">-0.767</td>
<td>Prob(JB):</td>
<td>0.356</td>
</tr>
<tr>
<td style="text-align:right">Kurtosis:</td>
<td style="text-align:right">2.638</td>
<td>Cond. No.</td>
<td>25.0</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Notes:<br>
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</p>
</blockquote>
<pre><code class="language-python"># 繁琐, =&gt; 暂无对标

from sklearn.linear_model import LinearRegression

# sklearn经典的5段式

# 1. 载入模型
model = LinearRegression()

# 2. 拆分训练集, 测试集
# sklearn, 要求的输入数据必须是二维的
x = [[1, e] for e in range(1, 21)]

# 自变量在前 因变量在后
# 3.训练模型
model.fit(x, y)
# 4. 模型预测
predicts = model.predict(x) # 预测值

# 5. 打分/输出结果
# 相关系数
R2 = model.score(x, y)
print('R2 = %.2f' % R2)
# 斜率
coef = model.coef_
# 截距
intercept = model.intercept_
print(model.coef_, model.intercept_)
</code></pre>
<pre><code class="language-bash">R2 = 0.94
[0.         0.96992481] 0.5157894736842081
</code></pre>
<p>关于一元线性回归模型的拟合的各种细节和问题, 将在 <code>&lt;一元线性回归详解&gt;</code>一文详述.</p>
<h2 id="五-小结">五. 小结</h2>
<p>正如对于电力系统的调侃一样, 人类各种形式电力的实现多是烧开水.</p>
<p>同样的, 不管什么数学模型, 其最终目标多是在于实现收敛, 至于如何实现收敛, 如何快速收敛, 这是个问题.</p>
<p>类似问题: <a href="https://github.com/Kyouichirou/Ant_Clony_Optimization">Kyouichirou/Ant_Clony_Optimization: 旅行商问题-蚁群算法的解决 (github.com)</a></p>
<h3 id="51-回顾">5.1 回顾</h3>
<p>通常, 得到&quot;最优(全局/局部)&quot;解的可能:</p>
<ul>
<li>数学推导, 通常情况下都较容易得到全局最优</li>
<li>模拟逼近, 难以计算, 或者是推导过程过度复杂...</li>
</ul>
<figure data-type="image" tabindex="11"><a href="https://imgse.com/i/ppoSVWn"><img src="https://s1.ax1x.com/2023/04/06/ppoSVWn.png" alt="ppoSVWn.png" loading="lazy"></a></figure>
<p>(<em>机器学习-线性模型, 周志华</em>)</p>
<figure data-type="image" tabindex="12"><a href="https://imgse.com/i/ppoStQx"><img src="https://s1.ax1x.com/2023/04/06/ppoStQx.png" alt="ppoStQx.png" loading="lazy"></a></figure>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi>w</mi><mo>^</mo></mover><mo>∗</mo></msup><mo>=</mo><mo>(</mo><msup><mi>X</mi><mi>T</mi></msup><mi>X</mi><msup><mo>)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>X</mi><mi>T</mi></msup><mi>y</mi></mrow><annotation encoding="application/x-tex">\hat{w}^* = (X^TX)^{-1}X^Ty
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.738696em;vertical-align:0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.738696em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mbin mtight">∗</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span></span></p>
<p>将上述的矩阵转换为代码的形式</p>
<pre><code class="language-python">y = [10* e + 35 for e in range(1, 101)]

mw = np.mat([[1.0, i] for i in range(1, 101)], float)

my = np.mat(y, float)

theta = (mw.T * mw).I * mw.T * my.T

print(theta)
[[35.]
 [10.]]
</code></pre>
<pre><code class="language-python">y = [
    3, 4, 5, 5, 2, 4, 7, 8, 11, 8, 12,
    11, 13, 13, 16, 17, 18, 17, 19, 21
]

mw = np.mat([[1.0, i] for i in range(1, 21)], float)

my = np.mat(y, float)

theta = (mw.T * mw).I * mw.T * my.T

print(theta)

[[0.51578947]
 [0.96992481]]
</code></pre>
<pre><code class="language-python">(mw.T * mw).I
# 等价于
(mw.T * mw) ** -1
</code></pre>
<pre><code class="language-python">np.matrix('[1, 2, 3; 1, 0, -1; 0, 1, 1]').I * np.matrix('[1, 2, 3; 1, 0, -1; 0, 1, 1]')

matrix([[1., 0., 0.],
        [0., 1., 0.],
        [0., 0., 1.]])
</code></pre>
<figure data-type="image" tabindex="13"><a href="https://imgse.com/i/ppbFOAI"><img src="https://s1.ax1x.com/2023/04/09/ppbFOAI.png" alt="ppbFOAI.png" loading="lazy"></a></figure>
<p>(<em>图: 应用回归分析, 何晓群</em>)</p>
<ul>
<li><a href="https://ibs.bfsu.edu.cn/chenxi/MathinEconII/LPChapter2_withsoln.pdf">矩阵_ibs.bfsu.edu.cn</a></li>
</ul>
<p><em>数学是如此美妙....!</em></p>
<h2 id="六-参考">六. 参考</h2>
<p>主要参考:</p>
<ul>
<li>&lt; 机器学习 &gt;, 周志华, 西瓜书</li>
<li>&lt; 南瓜书 &gt;, datawhale (这是对上面西瓜书公式的详细推导), pumpkin book</li>
<li>&lt; 应用回归分析 &gt;, 何晓群</li>
<li><a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">随机梯度下降 - 维基百科 (wikipedia.org)</a></li>
<li><a href="https://iewaij.github.io/introDataScience/OLS.html">OLS (iewaij.github.io), 极大似然估计和最小二乘法</a></li>
<li><a href="https://www.cnblogs.com/wangguchangqing/p/10521330.html">一文搞懂深度学习中的梯度下降</a></li>
<li><a href="https://www.cs.cornell.edu/courses/cs4780/2018fa/lectures/lecturenote07.html">Gradient Descent (and Beyond)</a></li>
</ul>

            </div>
            
            
              <div class="post-footer">
  <ul class="post-copyright">
    <li class="post-copyright-author">
      <strong class="language" data-lan="author">本文作者：</strong>
      Lian
    </li>
    <li class="post-copyright-link">
      <strong class="language" data-lan="link">本文链接：</strong>
      <a href="https://Kyouichirou.github.io/post/ji-qi-xue-xi-ti-du-xia-jiang-de-jian-dan-li-jie/" title="机器学习-梯度下降的简单理解">https://Kyouichirou.github.io/post/ji-qi-xue-xi-ti-du-xia-jiang-de-jian-dan-li-jie/</a>
    </li>
    <li class="post-copyright-license">
      <strong class="language" data-lan="copyright">版权声明： </strong>
      本博客所有文章除特别声明外，均采用<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i> BY-NC-SA</a> 许可协议。转载请注明出处！
    </li>
  </ul>
  <div class="tags">
    
      <a href="https://Kyouichirou.github.io/tag/bxmmKSW1O/"># math</a>
    
      <a href="https://Kyouichirou.github.io/tag/w2qaY4U6Ss/"># machine learning</a>
    
  </div>
  <div class="nav">
    <div class="nav-prev">
      
        <i class="fa fa-chevron-left"></i>
        <a class="nav-pc-next" title="一元线性回归详解" href="https://Kyouichirou.github.io/post/yi-yuan-xian-xing-hui-gui-xiang-jie/">一元线性回归详解</a class="nav-pc-next">
        <a class="nav-mobile-prev" title="一元线性回归详解" href="https://Kyouichirou.github.io/post/yi-yuan-xian-xing-hui-gui-xiang-jie/">上一篇</a>
      
    </div>
    <div class="nav-next">
      
        <a class="nav-pc-next" title="Python关于数学的处理" href="https://Kyouichirou.github.io/post/python-guan-yu-shu-xue-de-chu-li/">Python关于数学的处理</a>
        <a class="nav-mobile-next" title="Python关于数学的处理" href="https://Kyouichirou.github.io/post/python-guan-yu-shu-xue-de-chu-li/">下一篇</a>
        <i class="fa fa-chevron-right"></i>
      
    </div>
  </div>
</div>
            
            
  

          </div>
        </div>
      </div>
    </div>
    <div class="footer-box">
  <footer class="footer">
    <center id="runTimeBox">
      已运行:<span id="run_time"></span>
    </center>
    <span id="busuanzi_container_site_pv">浏览数:<span id="busuanzi_value_site_pv"></span> 次</span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_uv">访客数:<span id="busuanzi_value_site_uv"></span> 人</span>

    <script>
      BirthDay = new Date('');
      if (BirthDay.getTime()) {
        function runTime() {
          str = "";
          today = new Date();
          timeold = today.getTime() - BirthDay.getTime();
          msPerDay = 24 * 60 * 60 * 1000;
          e_daysold = timeold / msPerDay;
          daysold = Math.floor(e_daysold);
          str += daysold + "天";
          return str;
        }
        setInterval(function () {
          $("#run_time").html(runTime());
        }, 1000);
      } else {
        document.querySelector('.footer').removeChild(document.querySelector('#runTimeBox'));
      }
    </script>
    <div class="poweredby">
      Powered by <a href="https://github.com/Kyouichirou" target="_blank">Kyouichirou</a>
    </div>
  </footer>
  
    
      <div class="drawer-box left" id="drawer_box">
        <span class="muse-line muse-line-first"></span>
        <span class="muse-line muse-line-middle"></span>
        <span class="muse-line muse-line-last"></span>
      </div>
      
        <div class="mist back-to-top" id="back_to_top">
          <i class="fa fa-arrow-up"></i>
          
        </div>
        
          
            
              <div class="bg-img">
                <img src="https://s1.ax1x.com/2023/03/24/ppBNvm6.jpg" />
              </div>
              
                
                  
                        
</div>
<script>
  let sideBarOpen = "sidebar-open";
  let body = document.body;
  let back2Top = document.querySelector("#back_to_top"),
    back2TopText = document.querySelector("#back_to_top_text"),
    drawerBox = document.querySelector("#drawer_box"),
    rightSideBar = document.querySelector(".sidebar"),
    viewport = document.querySelector("body");

  function scrollAnimation(currentY, targetY) {
    let needScrollTop = targetY - currentY;
    let _currentY = currentY;
    setTimeout(() => {
      const dist = Math.ceil(needScrollTop / 10);
      _currentY += dist;
      window.scrollTo(_currentY, currentY);
      if (needScrollTop > 10 || needScrollTop < -10) {
        scrollAnimation(_currentY, targetY);
      } else {
        window.scrollTo(_currentY, targetY);
      }
    }, 1);
  }

  back2Top.addEventListener("click", function (e) {
    scrollAnimation(document.scrollingElement.scrollTop, 0);
    e.stopPropagation();
    return false;
  });

  window.addEventListener("scroll", function (e) {
    let percent =
      (document.scrollingElement.scrollTop /
        (document.scrollingElement.scrollHeight -
          document.scrollingElement.clientHeight)) *
      100;
    if (percent > 1 && !back2Top.classList.contains("back-top-active")) {
      back2Top.classList.add("back-top-active");
    }
    if (percent == 0) {
      back2Top.classList.remove("back-top-active");
    }
    if (back2TopText) {
      back2TopText.textContent = Math.floor(percent);
    }
  });

  let hasCacu = false;
  window.addEventListener("resize", function (e) {
    calcuHeight();
  });

  function calcuHeight() {
    // 动态调整站点概览高度
    if (
      (!hasCacu && back2Top.classList.contains("pisces")) ||
      back2Top.classList.contains("gemini")
    ) {
      let sideBar = document.querySelector(".sidebar");
      let navUl = document.querySelector("#site_nav");
      sideBar.style =
        "margin-top:" + (navUl.offsetHeight + navUl.offsetTop + 15) + "px;";
      hasCacu = true;
    }
  }
  calcuHeight();

  let open = false,
    MOTION_TIME = 300,
    RIGHT_MOVE_DIS = "320px";

  if (drawerBox) {
    let rightMotions = document.querySelectorAll(".right-motion");
    let right = drawerBox.classList.contains("right");

    let transitionDir = right
      ? "transition.slideRightIn"
      : "transition.slideLeftIn";

    let openProp, closeProp;
    if (right) {
      openProp = {
        paddingRight: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingRight: "0px",
      };
    } else {
      openProp = {
        paddingLeft: RIGHT_MOVE_DIS,
      };
      closeProp = {
        paddingLeft: "0px",
      };
    }

    drawerBox.onclick = function () {
      open = !open;
      jQuery.Velocity(rightSideBar, "stop");
      jQuery.Velocity(viewport, "stop");
      jQuery.Velocity(rightMotions, "stop");
      if (open) {
        jQuery.Velocity(
          rightSideBar,
          {
            width: RIGHT_MOVE_DIS,
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, transitionDir, {});
            },
          }
        );
        jQuery.Velocity(viewport, openProp, {
          duration: MOTION_TIME,
        });
      } else {
        jQuery.Velocity(
          rightSideBar,
          {
            width: "0px",
          },
          {
            duration: MOTION_TIME,
            begin: function () {
              jQuery.Velocity(rightMotions, {
                opacity: 0,
              });
            },
          }
        );
        jQuery.Velocity(viewport, closeProp, {
          duration: MOTION_TIME,
        });
      }
      for (let i = 0; i < drawerBox.children.length; i++) {
        drawerBox.children[i].classList.toggle("muse-line");
      }
      drawerBox.classList.toggle(sideBarOpen);
    };
  }

  // 链接跳转
  let newWindow = "false";
  if (newWindow === "true") {
    let links = document.querySelectorAll(".post-body a");
    links.forEach((item) => {
      if (!item.classList.contains("btn")) {
        item.setAttribute("target", "_blank");
      }
    });
  }

  let faSearch = document.querySelector("#fa_search");
  faSearch &&
    faSearch.addEventListener("click", function () {
      document.querySelector("#search_mask").style = "";
    });

  // 代码高亮
  hljs.initHighlightingOnLoad();

  // 离开当前页title变化
  var leaveTitle = "";
  var normal_title = document.title;
  if (leaveTitle) {
    document.addEventListener("visibilitychange", function () {
      if (document.visibilityState == "hidden") {
        normal_title = document.title;
        document.title = leaveTitle;
      } else {
        document.title = normal_title;
      }
    });
  }
</script>

<link rel="stylesheet" href="/media/css/jquery.fancybox.css" />
<script src="/media/js/jquery.fancybox.js"></script>

<script>
  let images = document.querySelectorAll(".section img");
  images.forEach((image) => {
    var parent = image.parentElement;
    var next = image.nextElementSibling;
    parent.removeChild(image);
    var aelem = document.createElement("a");
    aelem.href = image.src;
    aelem.dataset["fancybox"] = "images";
    aelem.dataset["rel"] = "fancybox-button";
    aelem.classList.add("fancybox");
    aelem.appendChild(image);
    parent.insertBefore(aelem, next);
  });
</script>
    <div class="reward-mask" style="display: none;">
  <div class="reward-relative">
    <span class="close" aria-hidden="true">x</span>
    <div class="reward-body">
      <h2>感谢您的支持，我会继续努力的!</h2>
      <div class="reward-img-box">
        <div style="position: relative; width: 140px; height: 140px;">
          
          
          
        </div>
      </div>
      <p class="reward-word">扫码打赏，你说多少就多少</p>
      <p class="reward-tip"> </p>
    </div>
    <div class="bottom">
      
      
    </div>
  </div>
</div>
<style>
  .reward-mask {
    position: fixed;
    z-index: 99999;
    top: 0;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: #00000054;
  }

  .reward-relative {
    position: relative;
    width: 480px;
    text-align: center;
    margin: 0 auto;
    border-radius: 5px;
    background-color: #fff;
    top: 50%;
    margin-top: -205px;
  }

  .reward-relative .close {
    position: absolute;
    right: 10px;
    font-weight: normal;
    font-size: 16px;
    color: #929292;
  }

  .reward-body {
    padding: 40px 20px 20px;
  }

  .bottom {
    display: flex;
  }

  .reward-btn {
    text-align: center;
  }

  .reward-btn-text {
    display: inline-block;
    cursor: pointer;
    width: 60px;
    height: 60px;
    line-height: 60px;
    border-radius: 50%;
    background-color: #ff9734;
    color: #FFF;
    margin-top: 20px;
  }

  .pay-text {
    margin-top: 10px;
    padding: 10px;
    flex: 1;
    transition: all .2s linear;
  }

  .pay-text:hover {
    background-color: #a5a5a536;
  }

  .reward-body h2 {
    padding-top: 10px;
    text-align: center;
    color: #a3a3a3;
    font-size: 16px;
    font-weight: normal;
    margin: 0 0 20px;
  }

  .reward-body h2:after,
  .reward-body h2:before {
    font-family: Arial, Helvetica, sans-serif;
    background: 0 0;
    width: 0;
    height: 0;
    font-style: normal;
    color: #eee;
    font-size: 80px;
    position: absolute;
    top: 20px;
  }

  .reward-body h2:before {
    content: '\201c';
    left: 50px;
  }

  .reward-body h2:after {
    content: '\201d';
    right: 80px;
  }

  .reward-img-box {
    display: inline-block;
    padding: 10px;
    border: 6px solid #ea5f00;
    margin: 0 auto;
    border-radius: 3px;
    position: relative;
  }

  .reward-img {
    position: absolute;
    left: 0px;
    top: 0px;
    width: 100%;
    height: 100%;
  }

  @media (max-width: 767px) {
    .reward-relative {
      height: 100%;
      top: 0px;
      margin-top: 0;
      width: auto;
    }

    .reward-relative .bottom {
      flex-direction: column;
    }

    .reward-relative .pay-text {
      width: 80%;
      margin: 5px auto;
      border: 1px solid silver;
      padding: 6px;
      border-radius: 4px;
    }

    .reward-body h2:after {
      right: 40px;
    }

    .reward-body h2:after,
    .reward-body h2:before {
      font-size: 60px;
    }

    .reward-body h2:before {
      left: 20px;
    }
  }
</style>
<script>
  !function () {
    var mask = document.querySelector('.reward-mask');
    let close = document.querySelector('.reward-relative .close');
    let rewardBtn = document.querySelector('.reward-btn');

    let zfb = document.querySelector('#zfb'),
      wx = document.querySelector('#wx'),
      zfbBtn = document.querySelector('#zfbBtn'),
      wxBtn = document.querySelector('#wxBtn');

    if (zfbBtn && wxBtn) {
      zfbBtn.addEventListener('click', () => {
        jQuery.Velocity(zfb, 'transition.slideLeftIn', {
          duration: 400
        });
        jQuery.Velocity(wx, 'transition.slideRightOut', {
          display: 'none',
          duration: 400
        });
      });

      wxBtn.addEventListener('click', () => {
        jQuery.Velocity(wx, 'transition.slideRightIn', {
          duration: 400
        });
        jQuery.Velocity(zfb, 'transition.slideLeftOut', {
          display: 'none',
          duration: 400
        });
      });
    }

    rewardBtn && rewardBtn.addEventListener('click', (e) => {
      jQuery.Velocity(mask, 'transition.slideDownIn', {
        duration: 400
      })
    });

    close.addEventListener('click', (e) => {
      e.preventDefault();
      jQuery.Velocity(mask, 'transition.slideUpOut', {
        duration: 400
      })
    })
  }()
</script>

  </div>
</body>

<input hidden id="copy" />
<script>
  !function () {
    let times = document.querySelectorAll('.publish-time');
    for (let i = 0; i < times.length; i++) {
      let date = times[i].dataset.t;
      let time = Math.floor((new Date().getTime() - new Date(date).getTime()) / 1000);
      if (time < 60) {
        str = time + '秒之前';
      } else if (time < 3600) {
        str = Math.floor(time / 60) + '分钟之前';
      } else if (time >= 3600 && time < 86400) {
        str = Math.floor(time / 3600) + '小时之前';
      } else if (time >= 86400 && time < 259200) {
        str = Math.floor(time / 86400) + '天之前';
      } else {
        str = times[i].textContent;
      }
      times[i].textContent = str;
    }
  }();
</script>

<script>
  let language = 'en';
  if (language !== '') {
    let map = new Map();
    if (language === 'en') {
      map.set('search', 'Search');
      map.set('category', 'Categories');
      map.set('article', 'Articles');
      map.set('tag', 'Tags');
      map.set('top', 'Top');
      map.set('publish', 'published');
      map.set('minute', ' minutes');
      map.set('read-more', 'Read More');
      map.set('view', 'View');
      map.set('words', ' words');
      map.set('category-in', 'category in');
      map.set('preview', 'Meta');
      map.set('index', 'Toc');
      map.set('no-archives', "You haven't created yet");
      map.set('archives', " articles in total");
      map.set('cloud-tags', " tags in total");
      map.set('copyright', "Copyright: ");
      map.set('author', "Author: ");
      map.set('link', "Link: ");
      map.set('leave-message', "Leave a message");
      map.set('format', "Links Format");
      map.set('site-name', "Name: ");
      map.set('site-link', "Link: ");
      map.set('site-desc', "Desc: ");
      map.set('stat', " related results, taking ");
      map.set('stat-time', " ms");
      map.set('site-img', "Image: ");
    }

    if (map.size > 0) {
      let lanElems = document.querySelectorAll('.language');
      lanElems.forEach(elem => {
        let lan = elem.dataset.lan, text = map.get(lan);
        if (elem.__proto__ === HTMLInputElement.prototype) {
          elem.placeholder = text
        } else {
          if (elem.dataset.count) {
            text = elem.dataset.count + text;
          }
          elem.textContent = text;
        }
      })
    }
  }

  window.Clipboard = (function (window, document, navigator) {
    var textArea,
      copy;

    // 判断是不是ios端
    function isOS() {
      return navigator.userAgent.match(/ipad|iphone/i);
    }
    //创建文本元素
    function createTextArea(text) {
      textArea = document.createElement('textArea');
      textArea.value = text;
      textArea.style.width = 0;
      textArea.style.height = 0;
      textArea.clientHeight = 0;
      textArea.clientWidth = 0;
      document.body.appendChild(textArea);
    }
    //选择内容
    function selectText() {
      var range,
        selection;

      if (isOS()) {
        range = document.createRange();
        range.selectNodeContents(textArea);
        selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        textArea.setSelectionRange(0, 999999);
      } else {
        textArea.select();
      }
    }

    //复制到剪贴板
    function copyToClipboard() {
      try {
        document.execCommand("Copy")
      } catch (err) {
        alert("复制错误！请手动复制！")
      }
      document.body.removeChild(textArea);
    }

    copy = function (text) {
      createTextArea(text);
      selectText();
      copyToClipboard();
    };

    return {
      copy: copy
    };
  })(window, document, navigator);

  function copyCode(e) {
    if (e.srcElement.tagName === 'SPAN' && e.srcElement.classList.contains('copy-code')) {
      let code = e.currentTarget.querySelector('code');
      var text = code.innerText;
      if (e.srcElement.textContent === '复制成功') {
        return;
      }
      e.srcElement.textContent = '复制成功';
      (function (elem) {
        setTimeout(() => {
          if (elem.textContent === '复制成功') {
            elem.textContent = '复制代码'
          }
        }, 1000);
      })(e.srcElement)
      Clipboard.copy(text);
    }
  }

  let pres = document.querySelectorAll('pre');
  pres.forEach(pre => {
    let code = pre.querySelector('code');
    let copyElem = document.createElement('span');
    copyElem.classList.add('copy-code');
    copyElem.textContent = '复制代码';
    pre.appendChild(copyElem);
    pre.onclick = copyCode
  })

</script>
<script src="/media/js/motion.js"></script>


  <script
    src="https://cdn.staticfile.org/smooth-scroll/16.1.3/smooth-scroll.polyfills.min.js"></script>
  <script>
    var scroll = new SmoothScroll('a[href*="#"]', {
      speed: 200
    });
  </script>






  <div class="snow-container"></div>
  <script src="/media/js/bg/snow.js"></script>

</html>